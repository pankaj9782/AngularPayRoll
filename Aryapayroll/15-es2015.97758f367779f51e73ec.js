(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{goCz:function(t,e,r){"use strict";r.r(e),r.d(e,"DepartmentModule",(function(){return E}));var s=r("ofXK"),i=r("tyNb"),a=r("fXoL");let n=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Nb({type:t,selectors:[["app-department"]],decls:1,vars:0,template:function(t,e){1&t&&a.Ub(0,"router-outlet")},directives:[i.g],styles:[""]}),t})();var o=r("CG1p"),c=r("PSD3"),b=r.n(c),p=r("tk/3"),d=r("JIr8"),l=r("z6cu"),m=r("AytR");let u=(()=>{class t{constructor(t){this.http=t,this.endpoint=m.a.apiBaseUrl,this.headers=(new p.c).set("Contant-Type","application/x-www-form-urlencoded")}errorMgmt(t){try{let e="";return e=t.error instanceof ErrorEvent?t.error.message:`Error code:${t.status}\nMessage:${e}`,console.log(e),Object(l.a)(e)}catch(e){console.log(e.message)}}getDepartment(){try{const t=sessionStorage.getItem("companyId");return this.http.get(`${this.endpoint}/departments/list-all/${t}`).pipe(Object(d.a)(this.errorMgmt))}catch(t){console.log(t)}}getDepartmentDetails(t){try{return this.http.get(`${this.endpoint}/branch/department-details/${t}`).pipe(Object(d.a)(this.errorMgmt))}catch(e){console.log(e)}}addDepatment(t,e){try{const r=sessionStorage.getItem("companyId");return this.http.post(`${this.endpoint}/branch/add-department/${e}/${r}`,t).pipe(Object(d.a)(this.errorMgmt))}catch(r){console.log(r)}}updateDepartment(t,e,r){try{return this.http.post(`${this.endpoint}/branch/update-department/${e}/${r}`,t).pipe(Object(d.a)(this.errorMgmt))}catch(s){console.log(s)}}removeData(t){try{return this.http.delete(`${this.endpoint}/branch/delete-department/${t}`).pipe(Object(d.a)(this.errorMgmt))}catch(e){console.log(e)}}DepartmentList(){try{const t=sessionStorage.getItem("companyId");return this.http.get(`${this.endpoint}/company/branch-list/${t}`).pipe(Object(d.a)(this.errorMgmt))}catch(t){console.log(t)}}}return t.\u0275fac=function(e){return new(e||t)(a.dc(p.a))},t.\u0275prov=a.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var h=r("cnwL");function g(t,e){if(1&t){const t=a.ac();a.Zb(0,"tbody"),a.Zb(1,"tr"),a.Zb(2,"td"),a.Zb(3,"b"),a.Ic(4),a.Yb(),a.Yb(),a.Zb(5,"td"),a.Ic(6),a.Yb(),a.Zb(7,"td"),a.Ic(8),a.Yb(),a.Zb(9,"td"),a.Zb(10,"a",7),a.Ub(11,"i",8),a.Yb(),a.Ic(12,"\xa0 "),a.Zb(13,"button",9),a.gc("click",(function(){a.Bc(t);const r=e.$implicit;return a.jc().showConfirmationMessage(r._id)})),a.Ub(14,"i",10),a.Yb(),a.Yb(),a.Yb(),a.Yb()}if(2&t){const t=e.$implicit,r=e.index,s=a.jc();a.Hb(4),a.Kc("",r+1,"."),a.Hb(2),a.Kc(" ",t.title," "),a.Hb(2),a.Kc(" ",t.description,""),a.Hb(2),a.Lb("disabled",-1===s.permissionInfo.search("Edit Department")),a.sc("routerLink","/pages/department/update-department/",t._id,"/",t.userId,""),a.Hb(3),a.pc("disabled",-1===s.permissionInfo.search("Delete Department"))}}let f=(()=>{class t{constructor(t,e,r){this.api=t,this.route=e,this.util=r,this.departmentData=[],this.showCard={}}ngOnInit(){this.departmentList(),this.permissionInfo=this.util.permissionRoleInfo}departmentList(){try{this.api.getDepartment().subscribe(t=>{"success"!==t.status&&200!==t.status||(this.departmentData=t.data,0==this.departmentData.length&&this.route.navigateByUrl("/pages/department/add-department"))})}catch(t){console.log(t)}}showConfirmationMessage(t){const e=b.a.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});e.fire({title:"Are you sure?",text:"You want to delete it",type:"warning",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No",reverseButtons:!0,allowOutsideClick:!1}).then(r=>{r.value?this.api.removeData(t).subscribe(t=>{"success"===t.status||200===t.status?e.fire("Deleted!","Your row has been deleted.","success"):"error"===t.status&&e.fire("ERROR!",t.message,"error"),this.departmentList()}):r.dismiss===b.a.DismissReason.cancel&&e.fire("Cancelled","Your list data safe","error")})}addDepartment(){try{this.util.departmentSatus=1}catch(t){console.log(t)}}}return t.\u0275fac=function(e){return new(e||t)(a.Tb(u),a.Tb(i.b),a.Tb(h.a))},t.\u0275cmp=a.Nb({type:t,selectors:[["app-list-department"]],decls:19,vars:2,consts:[[1,"card"],[1,"card-header",2,"text-align","center"],["type","button","routerLink","/pages/department/add-department",1,"btn","btn-primary",2,"float","right",3,"disabled","click"],[1,"fa","fa-plus-square"],[1,"table",2,"text-align","center"],[1,"text-primary"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"routerLink"],[1,"fa","fa-pencil-square-o"],["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash"]],template:function(t,e){1&t&&(a.Zb(0,"div",0),a.Zb(1,"div",1),a.Zb(2,"h2"),a.Ic(3,"Departments List"),a.Yb(),a.Zb(4,"button",2),a.gc("click",(function(){return e.addDepartment()})),a.Ub(5,"i",3),a.Ic(6,"\xa0 Add Department"),a.Yb(),a.Yb(),a.Zb(7,"table",4),a.Zb(8,"thead",5),a.Zb(9,"tr"),a.Zb(10,"th"),a.Ic(11," S.No "),a.Yb(),a.Zb(12,"th"),a.Ic(13," Title "),a.Yb(),a.Zb(14,"th"),a.Ic(15,"description"),a.Yb(),a.Zb(16,"th"),a.Ic(17," Action "),a.Yb(),a.Yb(),a.Yb(),a.Gc(18,g,15,8,"tbody",6),a.Yb(),a.Yb()),2&t&&(a.Hb(4),a.pc("disabled",-1===e.permissionInfo.search("Create Department")),a.Hb(14),a.pc("ngForOf",e.departmentData))},directives:[i.c,s.l,i.e],styles:[""]}),t})();var v=r("3Pt+");function I(t,e){if(1&t&&(a.Zb(0,"p",22),a.Zb(1,"strong"),a.Ic(2),a.Yb(),a.Yb()),2&t){const t=a.jc();a.Hb(2),a.Jc(t.errMsg)}}function Y(t,e){if(1&t&&(a.Zb(0,"p",23),a.Zb(1,"strong"),a.Ic(2),a.Yb(),a.Yb()),2&t){const t=a.jc();a.Hb(2),a.Jc(t.successMsg)}}function Z(t,e){if(1&t&&(a.Zb(0,"option",24),a.Ic(1),a.Yb()),2&t){const t=e.$implicit;a.qc("value",t._id),a.Hb(1),a.Kc(" ",t.name," ")}}function D(t,e){if(1&t&&(a.Zb(0,"div",26),a.Ic(1),a.Yb()),2&t){const t=a.jc().$implicit;a.Hb(1),a.Kc(" ",t.message," ")}}function y(t,e){if(1&t&&(a.Zb(0,"div"),a.Gc(1,D,2,1,"div",25),a.Yb()),2&t){const t=e.$implicit,r=a.jc();a.Hb(1),a.pc("ngIf",r.DepartmentForm.get("branchId").hasError(t.type)&&(r.DepartmentForm.get("branchId").dirty||r.DepartmentForm.get("branchId").touched))}}function M(t,e){if(1&t&&(a.Zb(0,"div",26),a.Ic(1),a.Yb()),2&t){const t=a.jc().$implicit;a.Hb(1),a.Kc(" ",t.message," ")}}function w(t,e){if(1&t&&(a.Zb(0,"div"),a.Gc(1,M,2,1,"div",25),a.Yb()),2&t){const t=e.$implicit,r=a.jc();a.Hb(1),a.pc("ngIf",r.DepartmentForm.get("title").hasError(t.type)&&(r.DepartmentForm.get("title").dirty||r.DepartmentForm.get("title").touched))}}function F(t,e){if(1&t&&(a.Zb(0,"p",17),a.Zb(1,"strong"),a.Ic(2),a.Yb(),a.Yb()),2&t){const t=a.jc();a.Hb(2),a.Jc(t.errMsg)}}function H(t,e){if(1&t&&(a.Zb(0,"p",18),a.Zb(1,"strong"),a.Ic(2),a.Yb(),a.Yb()),2&t){const t=a.jc();a.Hb(2),a.Jc(t.successMsg)}}function T(t,e){if(1&t&&(a.Zb(0,"div",20),a.Ic(1),a.Yb()),2&t){const t=a.jc().$implicit;a.Hb(1),a.Kc(" ",t.message," ")}}function U(t,e){if(1&t&&(a.Zb(0,"div"),a.Gc(1,T,2,1,"div",19),a.Yb()),2&t){const t=e.$implicit,r=a.jc();a.Hb(1),a.pc("ngIf",r.DepartmentUpdateForm.get("title").hasError(t.type)&&(r.DepartmentUpdateForm.get("title").dirty||r.DepartmentUpdateForm.get("title").touched))}}const $=[{path:"",component:n,canActivate:[o.a],children:[{path:"list-department",component:f},{path:"add-department",component:(()=>{class t{constructor(t,e,r,s,i,a){this.fb=t,this.api=e,this.router=r,this.ngZone=s,this.route=i,this.util=a,this.successMessage=!1,this.errorMsg=!1,this.validationMessage={title:[{type:"required",message:"Title is required"}],branchId:[{type:"required",message:"Branch Name is required"}]},this.isListAvaliable()}ngOnInit(){this.permissionInfo=this.util.permissionRoleInfo,this.departmentDataValidate(),this.departmentName(),-1===this.permissionInfo.search("Create Department")&&this.DepartmentForm.disable()}departmentDataValidate(){try{this.DepartmentForm=this.fb.group({title:new v.f("",v.v.required),description:new v.f(""),branchId:new v.f("",v.v.required)})}catch(t){console.log(t)}}submitDepatmentData(){try{let t=this.util.cleanFormLevelOne(this.DepartmentForm);this.api.addDepatment(t.value,this.branchId).subscribe(t=>{"success"===t.status||200===t.status?(this.successMessage=!0,this.errorMsg=!1,this.successMsg=t.message,setTimeout(()=>{this.handleErrors(),this.ngZone.run(()=>this.router.navigateByUrl("/pages/department/list-department"))},1500)):"error"==t.status&&(this.errorMsg=!0,this.successMessage=!1,this.errMsg=t.message,setTimeout(()=>{this.handleErrors()},3e3))})}catch(t){console.log(t)}}departmentName(){this.api.DepartmentList().subscribe(t=>{this.departmentNameList=t.branch})}onClick(t){this.branchId=t}handleErrors(){this.errorMsg=!1,this.successMessage=!1,this.errMsg="",this.successMsg=""}isListAvaliable(){try{this.api.getDepartment().subscribe(t=>{"success"===t.status&&t.data.length>0&&1!==this.util.departmentSatus&&(this.router.navigateByUrl("/pages/department/list-department"),this.util.departmentSatus=0)})}catch(t){console.log(t)}}}return t.\u0275fac=function(e){return new(e||t)(a.Tb(v.e),a.Tb(u),a.Tb(i.b),a.Tb(a.E),a.Tb(i.a),a.Tb(h.a))},t.\u0275cmp=a.Nb({type:t,selectors:[["app-add-department"]],decls:47,vars:7,consts:[[1,"card","card-user"],[1,"card-header"],[1,"card-title","text-center"],[1,"card-body"],[1,"col-sm-offset-2"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["role","form","novalidate","",1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-md"],[1,"form-group"],[1,"col-sm-6","control-label"],[2,"color","darkred"],["Name","branchId","formControlName","branchId",1,"dropdown","dropdown-toggle","form-control",3,"change"],["ng-selected","true","value","","disabled","","selected","",1,"dropdown-item"],["class","dropdown-item",3,"value",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["type","text","id","title","placeholder","Enter Title","formControlName","title",1,"form-control"],["type","text","id","description","placeholder","Enter Description","formControlName","description",1,"form-control"],[1,"col-sm-offset-2","col-sm-10"],["type","submit",1,"btn","btn-success",3,"disabled"],["type","button","routerLink","../list-department",1,"btn","btn-danger"],[1,"alert","alert-danger"],[1,"alert","alert-success"],[1,"dropdown-item",3,"value"],["style","color:\xa0red;margin-left:\xa014px;",4,"ngIf"],[2,"color","red","margin-left","14px"]],template:function(t,e){1&t&&(a.Zb(0,"div",0),a.Zb(1,"div",1),a.Zb(2,"h2",2),a.Ic(3,"Department Details"),a.Yb(),a.Yb(),a.Zb(4,"div",3),a.Zb(5,"div",4),a.Gc(6,I,3,1,"p",5),a.Yb(),a.Zb(7,"div",4),a.Gc(8,Y,3,1,"p",6),a.Yb(),a.Zb(9,"form",7),a.gc("ngSubmit",(function(){return e.submitDepatmentData()})),a.Zb(10,"div",8),a.Zb(11,"div",9),a.Zb(12,"div",10),a.Zb(13,"label",11),a.Zb(14,"b"),a.Ic(15,"Branch-Name :\xa0"),a.Zb(16,"span",12),a.Ic(17,"*"),a.Yb(),a.Yb(),a.Yb(),a.Zb(18,"select",13),a.gc("change",(function(t){return e.onClick(t.target.value)})),a.Zb(19,"option",14),a.Ic(20,"----------Select Branch----------"),a.Yb(),a.Gc(21,Z,2,2,"option",15),a.Yb(),a.Gc(22,y,2,1,"div",16),a.Yb(),a.Yb(),a.Zb(23,"div",9),a.Zb(24,"div",10),a.Ic(25," \xa0"),a.Zb(26,"label",11),a.Zb(27,"b"),a.Ic(28,"Title:\xa0"),a.Zb(29,"span",12),a.Ic(30,"*"),a.Yb(),a.Yb(),a.Yb(),a.Zb(31,"div",4),a.Ub(32,"input",17),a.Gc(33,w,2,1,"div",16),a.Yb(),a.Yb(),a.Yb(),a.Zb(34,"div",9),a.Zb(35,"div",10),a.Zb(36,"label",11),a.Zb(37,"b"),a.Ic(38,"Enter Description :"),a.Yb(),a.Yb(),a.Zb(39,"div",4),a.Ub(40,"input",18),a.Yb(),a.Yb(),a.Yb(),a.Yb(),a.Zb(41,"div",10),a.Zb(42,"div",19),a.Zb(43,"button",20),a.Ic(44,"Submit"),a.Yb(),a.Zb(45,"button",21),a.Ic(46,"Cancel"),a.Yb(),a.Yb(),a.Yb(),a.Yb(),a.Yb(),a.Yb()),2&t&&(a.Hb(6),a.pc("ngIf",e.errorMsg),a.Hb(2),a.pc("ngIf",e.successMessage),a.Hb(1),a.pc("formGroup",e.DepartmentForm),a.Hb(12),a.pc("ngForOf",e.departmentNameList),a.Hb(1),a.pc("ngForOf",e.validationMessage.branchId),a.Hb(11),a.pc("ngForOf",e.validationMessage.title),a.Hb(10),a.pc("disabled",e.DepartmentForm.invalid))},directives:[s.m,v.x,v.o,v.i,v.u,v.n,v.g,v.q,v.w,s.l,v.c,i.c],encapsulation:2}),t})()},{path:"update-department/:id/:userId",component:(()=>{class t{constructor(t,e,r,s,i,a){this.fb=t,this.api=e,this.router=r,this.ngZone=s,this.route=i,this.util=a,this.successMessage=!1,this.errorMsg=!1,this.validationMessage={title:[{type:"required",message:"Title is required"}]};let n=this.route.snapshot.paramMap.get("id");this.util.moduleExists(n,"Department").subscribe(t=>{"success"===t.status&&(t.data||this.router.navigateByUrl("/pages/department/list-department"))})}ngOnInit(){this.permissionInfo=this.util.permissionRoleInfo,this.userId=this.route.snapshot.paramMap.get("id"),this.branchId=this.route.snapshot.paramMap.get("userId"),this.departmentDataValidate(),this.existingData(),-1===this.permissionInfo.search("Edit Department")&&this.DepartmentUpdateForm.disable()}existingData(){this.api.getDepartmentDetails(this.userId).subscribe(t=>{"success"==t.status&&(this.departmentData=t.data,this.DepartmentUpdateForm=this.fb.group({title:new v.f(this.departmentData.title,v.v.required),description:new v.f(this.departmentData.description)}))})}departmentDataValidate(){try{this.DepartmentUpdateForm=this.fb.group({title:new v.f("",v.v.required),description:new v.f("")})}catch(t){console.log(t)}}updateDepartment(){try{let t=this.util.cleanFormLevelOne(this.DepartmentUpdateForm);this.DepartmentUpdateForm.valid&&this.api.updateDepartment(t.value,this.branchId,this.userId).subscribe(t=>{"success"===t.status||200===t.status?(this.successMessage=!0,this.errorMsg=!1,this.successMsg=t.message,setTimeout(()=>{this.handleErrors(),this.router.navigateByUrl("/pages/department/list-department")},2e3)):"error"!==t.status&&404!==t.status||(this.errorMsg=!0,this.successMessage=!1,this.errMsg=t.message,setTimeout(()=>{this.handleErrors()},3e3))})}catch(t){console.log(t)}}handleErrors(){this.errorMsg=!1,this.successMessage=!1,this.errMsg="",this.successMsg=""}}return t.\u0275fac=function(e){return new(e||t)(a.Tb(v.e),a.Tb(u),a.Tb(i.b),a.Tb(a.E),a.Tb(i.a),a.Tb(h.a))},t.\u0275cmp=a.Nb({type:t,selectors:[["app-update-department"]],decls:31,vars:5,consts:[[1,"card","card-user"],[1,"card-header"],[1,"card-title","text-center"],[1,"card-body"],[1,"col-sm-offset-2"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["role","form","novalidate","",1,"form-horizontal",3,"formGroup","ngSubmit"],[1,"form-group"],[1,"col-sm-6","control-label"],[2,"color","darkred"],["type","text","id","title","placeholder","Enter Title","formControlName","title",1,"form-control"],[4,"ngFor","ngForOf"],["type","text","id","description","placeholder","Enter Description","formControlName","description",1,"form-control"],[1,"col-sm-offset-2","col-sm-10"],["type","submit",1,"btn","btn-success",3,"disabled"],["type","button","routerLink","../../../list-department",1,"btn","btn-danger"],[1,"alert","alert-danger"],[1,"alert","alert-success"],["style","color:\xa0red;margin-left:\xa014px;",4,"ngIf"],[2,"color","red","margin-left","14px"]],template:function(t,e){1&t&&(a.Zb(0,"div",0),a.Zb(1,"div",1),a.Zb(2,"h2",2),a.Ic(3,"Update Department"),a.Yb(),a.Yb(),a.Zb(4,"div",3),a.Zb(5,"div",4),a.Gc(6,F,3,1,"p",5),a.Yb(),a.Zb(7,"div",4),a.Gc(8,H,3,1,"p",6),a.Yb(),a.Zb(9,"form",7),a.gc("ngSubmit",(function(){return e.updateDepartment()})),a.Zb(10,"div",8),a.Zb(11,"label",9),a.Zb(12,"b"),a.Ic(13,"Title:\xa0"),a.Zb(14,"span",10),a.Ic(15,"*"),a.Yb(),a.Yb(),a.Yb(),a.Zb(16,"div",4),a.Ub(17,"input",11),a.Gc(18,U,2,1,"div",12),a.Yb(),a.Yb(),a.Zb(19,"div",8),a.Zb(20,"label",9),a.Zb(21,"b"),a.Ic(22,"Description: "),a.Yb(),a.Yb(),a.Zb(23,"div",4),a.Ub(24,"input",13),a.Yb(),a.Yb(),a.Zb(25,"div",8),a.Zb(26,"div",14),a.Zb(27,"button",15),a.Ic(28,"Update"),a.Yb(),a.Zb(29,"button",16),a.Ic(30,"Cancel"),a.Yb(),a.Yb(),a.Yb(),a.Yb(),a.Yb(),a.Yb()),2&t&&(a.Hb(6),a.pc("ngIf",e.errorMsg),a.Hb(2),a.pc("ngIf",e.successMessage),a.Hb(1),a.pc("formGroup",e.DepartmentUpdateForm),a.Hb(9),a.pc("ngForOf",e.validationMessage.title),a.Hb(9),a.pc("disabled",e.DepartmentUpdateForm.invalid||-1===e.permissionInfo.search("Edit Department")))},directives:[s.m,v.x,v.o,v.i,v.c,v.n,v.g,s.l,i.c],encapsulation:2}),t})()},{path:"",redirectTo:"list-department",pathMatch:"full"}]}];let x=(()=>{class t{}return t.\u0275mod=a.Rb({type:t}),t.\u0275inj=a.Qb({factory:function(e){return new(e||t)},imports:[[s.c,i.f.forChild($)]]}),t})(),E=(()=>{class t{}return t.\u0275mod=a.Rb({type:t}),t.\u0275inj=a.Qb({factory:function(e){return new(e||t)},imports:[[s.c,x,v.j,v.s,i.f]]}),t})()}}]);
//# sourceMappingURL=15-es2015.97758f367779f51e73ec.js.map
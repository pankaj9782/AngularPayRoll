{"version":3,"sources":["webpack:///src/app/pages/payroll/payroll.component.ts","webpack:///src/app/pages/payroll/payroll.component.html","webpack:///src/app/pages/payroll/payroll-service/payroll-api.service.ts","webpack:///src/app/pages/payroll/list-payroll/list-payroll.component.html","webpack:///src/app/pages/payroll/list-payroll/list-report.component.ts","webpack:///src/app/pages/payroll/add-payroll/add-payroll.component.ts","webpack:///src/app/pages/payroll/update-payroll/update-payroll.component.html","webpack:///src/app/pages/payroll/update-payroll/update-report.component.ts","webpack:///src/app/pages/payroll/payroll-routing.module.ts","webpack:///src/app/pages/payroll/payroll-sheet/payroll-sheet.component.ts","webpack:///src/app/pages/payroll/payroll-sheet/payroll-sheet.component.html","webpack:///src/app/pages/payroll/payroll.module.ts"],"names":["PayrollComponent","PayrollApiService","http","endpoint","environment","apiBaseUrl","headers","set","error","errorMessage","ErrorEvent","message","status","console","log","throwError","err","year","month","data","companyId","sessionStorage","getItem","this","post","pipe","catchError","errorMgmt","salarySlipId","get","employeeIdArray","modeType","type","salaryId","value","ListPayrollComponent","api","fb","employeeListAPI","spinner","notifier","existingData","demo","dataSalary","showPayrollDetials","salarySlipStatus","paymentModeType","name","showSalaryDetailsCards","showCheckbox","selectAllCheckBox","generateSalaryForEmployees","salarySlipDetails","currentMonthValue","filterOnEmployee","currentSalarySlipFilterStatus","showChequeBtn","dataSetting","currentMonthSetting","listSalarySlipDetails","monthValue","Number","i","toString","padStart","employeeList","getEmployeeList","subscribe","companyEmployeelist","show","document","getElementById","length","hide","fire","generateSlip","currentDate","Date","getFullYear","monthlyGenerateSlip","forEach","generatePdf","generateSalarySlip","items","_id","id","getSalarySlip","push","grossAmt","gross","amt","netSalaryAmt","netSalary","totalDeductionAmt","totalDeduction","employeeDetails","doc","image","Image","src","companyImageUrl","setFontSize","rect","addImage","setFontStyle","text","companyName","employeeName","accountNum","designation","present","earnedLeaves","unsanctionedLeave","payDays","monthlyctc","annuallyctc","maxLength","textY","deductions","earnings","rectY","undefined","label","save","headerSpace","yearValue","result","match","earnedLeaveYearMsg","key","getMonth","substring","filterEmployeeId","paymentMode","filterSalarySlip","filterCurrentSalarySlip","curretDate","returnData","String","setAttribute","getPayrolData","employeeFilter","isGenerated","employeeId","splice","employeeSalaryDetails","deductionDetails","earningDetails","removeAttribute","getChequeApi","response","title","input","inputValue","chequeNum","showCancelButton","inputValidator","then","addChequeApi","checkNum","notify","filterFunctionality","yearValidation","resetFunctionality","allDownload","AddPayrollComponent","UpdatePayrollComponent","route","ngZone","router","salarySlipDeductions","salarySlipEarnings","buttonValue","showButtonValue","salarySlipPattern","didUpdate","errorMsg","successMessage","snapshot","paramMap","requestMonth","requestYear","salarySlipForm","existingSalaryDetails","updateSalarySlipForm","group","deduction","totalDeductions","deductionForm","totalEarnings","earningsForm","element","updatedSalaryForm","successMsg","setTimeout","navigateByUrl","handelErrors","errMsg","scrollIntoView","showFunctinality","updateSalarySlip","path","component","canActivate","children","PayrollSheetComponent","apiService","titleCase","minMode","bsValue","requestDateDetails","bsConfig","Object","assign","dateInputFormat","getCompanyDetails","dateValues","localStorage","companyDetails","sheetType","bankStatement","statementType","generateBankSheet","generateCashStatement","generateChequeStatement","bankStatementData","workbook","Workbook","worksheet","addWorksheet","subHeading","totalAmoutPaid","transform","totalAmoutPaidWords","tableSubHeading","header1","headerDetails","footer","bankData","addRow","getCell","sheetHeading","subject","mergeCells","font","family","size","underline","bold","alignment","vertical","horizontal","wrapText","sheetSubHeading1","border","top","style","left","bottom","right","sheetSubHeading2","eachCell","cell","number","getColumn","width","d","f","xlsx","writeBuffer","blob","Blob","salaryStatementData","salaryInfo","index","cashAmt","footerRow","totalCashAmtPaid","chequeAmt","totalChequeAmtPaid","rangeDatesUpdated","statementSheet","redirectTo","pathMatch","PayrollRoutingModule","forChild","customNotifierOptions","position","distance","gap","theme","behaviour","autoHide","onClick","onMouseover","showDismissButton","stacking","animations","enabled","preset","speed","easing","offset","shift","overlap","PayrollModule","withConfig","forRoot"],"mappings":"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","file":"x","sourcesContent":["import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-payroll',\n  templateUrl: './payroll.component.html',\n  styleUrls: ['./payroll.component.scss']\n})\n\nexport class PayrollComponent implements OnInit {\n\n  constructor() {}\n  ngOnInit() {\n  \n  }\n\n}","<router-outlet></router-outlet>","import { Injectable } from '@angular/core';\nimport { HttpHeaders, HttpClient, HttpErrorResponse, HttpResponse } from '@angular/common/http';\nimport { catchError } from 'rxjs/operators';\nimport { Observable, throwError } from 'rxjs';\nimport { environment } from '../../../../environments/environment';\n\n\n@Injectable({\n  providedIn: 'root'\n})\n\nexport class PayrollApiService {\n\n  /** Here we provide daynamic environment value from environment */\n  endpoint: string = environment.apiBaseUrl;\n  headers = new HttpHeaders().set('Content-Type', 'application/x-www-form-urlencoded');//Set a Header Value.\n\n  constructor(private http: HttpClient) { }\n\n/**Create method for manage errors when request and return response from the server*/\nerrorMgmt(error: HttpErrorResponse) {\n  try {\n    let errorMessage = '';\n    /** Handle client side error */\n    if (error.error instanceof ErrorEvent) {\n      errorMessage = error.error.message;\n    }\n    /** Handle server side error */\n    else {\n      errorMessage = `Error code:${error.status}\\nMessage:${errorMessage}`;\n    }\n    console.log(errorMessage);\n    return throwError(errorMessage);\n  }\n  catch (err) {\n    console.log(err.message);\n  }\n}\n\ngetPayrolData(year,month):Observable<any>{\n  try{\n    let data = {\n      year:year,\n      month:month\n    }\n    const companyId = sessionStorage.getItem(\"companyId\");\n    let apiURL = `${this.endpoint}/employee/salary-slip-list/${companyId}`;\n    return this.http.post(apiURL,data).pipe(\n      catchError(this.errorMgmt)\n    )\n  }catch(err){\n    console.log(err);\n  }\n}\n\ngetSalarySlip(salarySlipId:String): Observable<any> {\n  try {\n    let apiURL = `${this.endpoint}/employee/salary-slip-details/${salarySlipId}`;\n    return this.http.get(apiURL).pipe(\n    catchError(this.errorMgmt)\n    )\n  }\n  catch (err) {\n    console.log(err);\n  }\n}\n\n// Generate Salary Slip\ngenerateSalarySlip(employeeIdArray,year,month): Observable<any>{\n  try{\n    let data = {\n      year:year,\n      month:month,\n      employeeIdArray: employeeIdArray.employeeIdArray\n    }\n    const companyId = sessionStorage.getItem(\"companyId\");\n    let apiURL = `${this.endpoint}/employee/generate-salary-slip/${companyId}`;\n    return this.http.post(apiURL,data).pipe(\n      catchError(this.errorMgmt)\n    )\n  }catch(err){\n    console.log(err);\n  }\n}\n\n// Filter Employee Data\nfilterSalarySlip(modeType,year,month):Observable<any>{\n  try {\n    let companyId = sessionStorage.getItem('companyId');\n    let apiURL = `${this.endpoint}/employee/filter-salary-slip/${companyId}/${modeType}/${year}/${month}`;\n    return this.http.get(apiURL).pipe(\n    catchError(this.errorMgmt)\n    )\n  }\n  catch (err) {\n    console.log(err);\n  }\n}\n\n// List Employee salary slip upto date\nlistSalarySlipDetails(month,year):Observable<any>{\n  try {\n    let companyId = sessionStorage.getItem('companyId');\n    let apiURL = `${this.endpoint}/employee/current-month-salary-slip/${companyId}/${year}/${month}`;\n    return this.http.get(apiURL).pipe(\n    catchError(this.errorMgmt)\n    )\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n// Generate and Update the employee salary slip\nmonthlyGenerateSlip(data,month,year,type): Observable<any>{\ntry {\n  let companyId = sessionStorage.getItem('companyId');\n  let apiURL = `${this.endpoint}/employee/generate-current-month-slip/${companyId}/${year}/${month}/${type}`;\n      return this.http.post(apiURL,data).pipe(\n        catchError(this.errorMgmt)\n      )\n} catch (error) {\n  console.log(error);\n}\n}\n\n// Filter Employee Data\nfilterCurrentSalarySlip(modeType,year,month):Observable<any>{\n  try {\n    let companyId = sessionStorage.getItem('companyId');\n    let apiURL = `${this.endpoint}/employee/filter-current-month-salary-slip/${companyId}/${modeType}/${year}/${month}`;\n    return this.http.get(apiURL).pipe(\n    catchError(this.errorMgmt)\n    )\n  }\n  catch (err) {\n    console.log(err);\n  }\n}\n\n\n// GENERATE BANK STATEMENT(SALARY UPLOAD) API\n bankStatement(data): Observable<any> {\n   try {\n    let companyId = sessionStorage.getItem('companyId');\n    let apiURL = `${this.endpoint}/company/bank-statement/${companyId}`;\n    return this.http.post(apiURL, data).pipe(\n    catchError(this.errorMgmt)\n    )\n   } catch (error) {\n     console.log(error);\n   }\n }\n\n\n//  ADD CHEQUE DETAILS API\naddChequeApi(salaryId,data):Observable<any> {\n  try {\n    let apiUrl = `${this.endpoint}/user/add-cheque-details/${salaryId}`;\n    return this.http.post(apiUrl, data).pipe(\n      catchError(this.errorMgmt)\n      )\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n\n//  GET CHEQUE DETAILS API\ngetChequeApi(salaryId):Observable<any> {\n  try {\n    let apiUrl = `${this.endpoint}/user/get-cheque-details/${salaryId}`;\n    return this.http.get(apiUrl).pipe(\n      catchError(this.errorMgmt)\n      )\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n//  GET CHEQUE DETAILS API\ngetCompanyDetails(companyId):Observable<any> {\n  try {\n    let apiUrl = `${this.endpoint}/company/details/${companyId}`;\n    return this.http.get(apiUrl).pipe(\n      catchError(this.errorMgmt)\n      )\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n\n}\n","<ngx-spinner bdColor=\"rgba(51,51,51,0.8)\" size=\"medium\" color=\"#fff\" type=\"timer\">\n</ngx-spinner>\n<notifier-container></notifier-container>\n<div class=\"card card-user\">\n    <div class=\"card-header\" (keyup.enter)=\"filterFunctionality()\">\n        <h2 class=\"card-title text-center\">Payroll Details</h2>\n    </div>\n\n    <div class=\"card-body\">\n        <div class=\"form-row\">\n            <div class=\"col-lg-3 col-md-3 col-sm-12\">\n                <div class=\"form-group\">\n                    <label class=\"col-sm-6 control-label \"><b>Select Employee:</b></label>\n                    <select class=\"dropdown dropdown-toggle form-control\" id=\"salaryEmployee\" (change)=\"employeeFilter()\">\n                        <option class=\"dropdown-item\" value=\"\" disabled selected>--Select Employee--</option>\n                        <option class=\"dropdown-item\" *ngFor=\"let employee of companyEmployeelist\"\n                            value=\"{{employee._id}}\">{{employee.name}}</option>\n                    </select>\n                </div>\n            </div>\n\n            <div class=\"col-lg-3 col-md-3 col-sm-12\">\n                <div class=\"form-group\">\n                    <label class=\"col-sm-6 control-label \"><b>Enter Year:</b></label>\n                    <div class=\"col-sm-offset-2\">\n                        <input class=\"form-control\" type=\"text\" id=\"payrollYear\" (keyup)=\"yearValidation()\" placeholder=\"Enter Year\">\n                    </div>\n                    <div>\n                        <p style=\"color:red;\">{{earnedLeaveYearMsg}}</p>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"col-lg-3 col-md-3 col-sm-12\">\n                <div class=\"form-group\">\n                    <label class=\"col-sm-6 control-label \"><b>Enter Month:</b></label>\n                    <div class=\"col-sm-offset-2\">\n                        <select class=\"dropdown dropdown-toggle form-control\" id=\"salarySlipMonth\">\n                            <option [disabled]=\"!currentMonthValue['01']\" class=\"dropdown-item\" id=\"01\" value=\"01\">Jan\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['02']\" class=\"dropdown-item\" id=\"02\" value=\"02\">Feb\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['03']\" class=\"dropdown-item\" id=\"03\" value=\"03\">Mar\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['04']\" class=\"dropdown-item\" id=\"04\" value=\"04\">Apr\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['05']\" class=\"dropdown-item\" id=\"05\" value=\"05\">May\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['06']\" class=\"dropdown-item\" id=\"06\" value=\"06\">Jun\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['07']\" class=\"dropdown-item\" id=\"07\" value=\"07\">Jul\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['08']\" class=\"dropdown-item\" id=\"08\" value=\"08\">Aug\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['09']\" class=\"dropdown-item\" id=\"09\" value=\"09\">Sep\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['10']\" class=\"dropdown-item\" id=\"10\" value=\"10\">Oct\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['11']\" class=\"dropdown-item\" id=\"11\" value=\"11\">Nov\n                            </option>\n                            <option [disabled]=\"!currentMonthValue['12']\" class=\"dropdown-item\" id=\"12\" value=\"12\">Dec\n                            </option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"col-lg-3 col-md-3 col-sm-12\">\n                <div class=\"form-group\">\n                    <label class=\"col-sm-6 control-label \"><b>Salary Slip</b></label>\n                    <div class=\"col-sm-offset-2\">\n                        <select class=\"dropdown dropdown-toggle form-control\" id=\"salarySlipType\" [disabled]='filterOnEmployee'>\n                            <option class=\"dropdown-item\" value=\"former\">Formerly Generated</option>\n                            <option class=\"dropdown-item\" value=\"later\">Generate Later</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n\n        <div class=\"form-row\">\n            <div class=\"col-lg-3 col-md-3 col-sm-12\">\n                <div class=\"form-group\">\n                    <label class=\"col-sm-6 control-label \"><b>Pay Mode:</b></label>\n                    <div class=\"col-sm-offset-2\">\n                        <select class=\"dropdown dropdown-toggle form-control\" id=\"salaryModeType\" [disabled]='filterOnEmployee'>\n                                <option class=\"dropdown-item\" value=\"\" disabled selected>--Select Payment Mode--</option>\n                                <option class=\"dropdown-item\" *ngFor=\"let modeType of paymentModeType\" value=\"{{modeType.value}}\">\n                                    {{modeType.name}}</option>\n                            </select>\n                    </div>\n                </div>\n            </div>\n            <div class=\"col-lg-3 col-md-3 col-sm-12\">\n                <div class=\"form-group right-buttongroup\">\n                    <button class=\"btn btn-primary btn-margin\" [disabled]=\"earnedLeaveYearMsg\" (click)=\"filterFunctionality()\"><i class=\"fa fa-filter\"></i>&nbsp; Filter</button>\n                    <button class=\"btn btn-danger btn-margin\" (click)=\"resetFunctionality()\"><i class=\"fa fa-trash\"></i>&nbsp;  Reset</button>\n                </div>\n            </div>\n\n        </div>\n\n\n\n        <!-- <button style=\"float: right;\" class=\"btn btn-primary btn-round\" [disabled]=\"earnedLeaveYearMsg || bankStatementFlag\" (click)=\"bankStatement()\"><i class=\"fas fa-download\"></i>&nbsp;{{statementName}}</button> -->\n        <button style=\"float: right;\" class=\"btn btn-success btn-round\" [disabled]=\"earnedLeaveYearMsg || dataSalary.length ===0\" (click)=\"allDownload()\"><i class=\"fas fa-download\"></i>&nbsp; Download All</button>\n        <table class=\"table\" style=\"text-align: center;\">\n            <thead class=\" text-primary\">\n                <tr>\n                    <th>Generate Payroll\n                        <div *ngIf=\"dataSalary.length > 0 && currentSalarySlipFilterStatus === 'later'\">\n                            <input type=\"checkbox\" [checked]=\"selectAllCheckBox\" (change)=\"headerCheckBox()\" /> Select All\n                        </div>\n                    </th>\n                    <th>Name</th>\n                    <!-- <th>Designation</th> -->\n                    <th>Gross Salary</th>\n                    <th>Salary Deduction</th>\n                    <th>Net Salary</th>\n                    <th>Action</th>\n                </tr>\n            </thead>\n            <tbody *ngFor=\"let list of dataSalary\">\n                <tr>\n                    <td *ngIf=\"!list.isGenerated\"><input type=\"checkbox\" [checked]=\"showCheckbox[list._id]\" (change)=listCheckBoxes(list._id) /></td>\n                    <td *ngIf=\"list.isGenerated\"><i class=\"fa fa-check\" style=\"color: green; font-size: 25px;\"></i></td>\n                    <td>{{list.employeeDetails.employeeName}}</td>\n                    <!-- <td>{{ list.employeeDetails.designation }}</td>   -->\n                    <td>{{ list.gross.amt }}</td>\n                    <td>{{ list.totalDeduction.amt }}</td>\n                    <td>{{list.netSalary.amt}}</td>\n                    <td>\n                        <button *ngIf=\"showChequeBtn\" class=\"btn btn-danger\" type=\"button\" (click)=\"addChequeNo(list._id)\"><i class=\"fas fa-edit\"></i></button>&nbsp;\n                        <button title=\"info\" class=\"btn btn-primary\" type=\"button\" (click)=\"showSalarySlipDetails(list._id)\"><i class=\"fas fa-info\"></i></button>&nbsp;\n                        <button *ngIf=\"list.isGenerated\" class=\"btn btn-default btn-fab btn-icon btn-round\" type=\"button\" (click)=\"generatePdf(list._id)\"><i class=\"fas fa-file-download\"></i></button>\n\n                    </td>\n                </tr>\n                <tr>\n                    <td colspan=\"6\">\n                        <div class=\"card\" style=\"background-color:whitesmoke\" [hidden]=\"showSalaryDetailsCards[list._id]\">\n                            <div *ngIf=\"salarySlipDetails[list._id] !== undefined\">\n                                <table width=100% class=\"payrollDetails1\" *ngFor=\"let empDetails of salarySlipDetails[list._id].employeeSalaryDetails\">\n                                    <tr>\n                                        <th class=\"text-center\" colspan=\"6\" ><b class=\"display-flex\">Payroll Details\n                                            <div *ngIf=\"!list.isGenerated\" class=\"margin-top3\">\n                                            <button title=\"Update\" class=\"editbutton\">\n                                                <a href=\"javascript:void(0);\" routerLink=\"/pages/payroll/update-payroll/{{list._id}}/{{list.month}}/{{list.year}}\"><i  class=\"fa fa-pencil-square-o\"></i></a>\n                                            </button>\n                                        </div></b>\n\n                                        </th>\n                                    </tr>\n                                    <tr>\n                                        <th>Annual CTC:</th>\n                                        <th>Monthly Pay:</th>\n                                        <th>Earned Leave Balance:</th>\n                                        <th>Account Number:</th>\n                                        <th>Present Days:</th>\n                                        <th>Pay Days:</th>\n                                    </tr>\n                                    <tr>\n                                        <td>{{ empDetails.annuallyctc }}</td>\n                                        <td>{{ empDetails.monthlyctc }}</td>\n                                        <td>{{ empDetails.earnedLeaves }}</td>\n                                        <td>{{ empDetails.accountNum }}</td>\n                                        <td>{{ empDetails.present }}</td>\n                                        <td>{{ empDetails.payDays }}</td>\n                                    </tr>\n                                    <tr>\n                                        <td colspan=\"3\">\n                                            <table width=\"100%\" class=\"innertable\" *ngFor=\"let empDetailsEarnings of salarySlipDetails[list._id].earningDetails; let i = index\">\n                                                <tr *ngIf=\"i===0\">\n                                                    <th colspan=\"2\">Total Earnings</th>\n                                                </tr>\n                                                <tr>\n                                                    <th>{{ empDetailsEarnings.label }}</th>\n                                                    <td>{{ empDetailsEarnings.amt }}</td>\n                                                </tr>\n                                            </table>\n                                        </td>\n                                        <td colspan=\"3\">\n                                            <table width=\"100%\" class=\"innertable\" *ngFor=\"let empDetailsDeductions of salarySlipDetails[list._id].deductionDetails; let i = index\">\n                                                <tr *ngIf=\"i===0\">\n                                                    <th colspan=2>Total Deductions</th>\n                                                </tr>\n                                                <tr>\n                                                    <th>{{ empDetailsDeductions.label }}</th>\n                                                    <td>{{ empDetailsDeductions.amt }}</td>\n                                                </tr>\n                                            </table>\n                                        </td>\n                                    </tr>\n\n                                </table>\n                            </div>\n                        </div>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n        <div *ngIf=\"salarySlipStatus.length != 0\">\n            <h3 style=\"text-align: center;\">{{ salarySlipStatus }}</h3>\n        </div>\n    </div>\n</div>","import { PayrollApiService } from '../payroll-service/payroll-api.service';\nimport { Component, OnInit } from '@angular/core';\nimport Swal from 'sweetalert2';\nimport * as jsPDF from 'jspdf'\nimport { FormBuilder } from '@angular/forms';\nimport { EmployeeService } from '../../employee-wizard/services/employee.service';\nimport { NgxSpinnerService } from 'ngx-spinner';\nimport { NotifierService } from 'angular-notifier';\n\n\n\n@Component({\n  selector: 'app-list-payroll',\n  templateUrl: './list-payroll.component.html',\n  styleUrls: ['./list-payroll.component.scss']\n})\n\nexport class ListPayrollComponent implements OnInit {\n\n  paymentData: any[];\n  existingData = [];\n  fixdetails: any[];\n  deductionList: any[];\n  earningsList: any[];\n  demo = [];\n  grossAmt;\n  netSalaryAmt;\n  totalDeductionAmt;\n  imgData;\n\n  dataSalary = [];\n  salarySlip: any[];\n  employeeDetails: any;\n  earnedLeaveYearMsg: string;\n  showPayrollDetials = false;\n  salarySlipStatus = '';\n  paymentModeType = [\n    {name: 'Transfer to Bank Account', value: 'Tansfer to Bank Account'},\n    {name: 'Cash', value: 'Cash'},\n    {name: 'Cheque', value: 'Cheque'}\n  ];\n  status = \"Active\";\n  companyEmployeelist: any;\n  showSalaryDetailsCards = {};\n  showCheckbox = {};\n  selectAllCheckBox = false;\n  generateSalaryForEmployees = [];\n  salarySlipDetails = {};\n  currentMonthValue = {};\n  filterOnEmployee = false;\n  filterEmployeeId: any;\n  currentSalarySlipFilterStatus = 'later';\n\n  showChequeBtn = false;\n\n  constructor(\n    private api: PayrollApiService,\n    private fb: FormBuilder,\n    private employeeListAPI: EmployeeService,\n    private spinner: NgxSpinnerService,\n    public notifier: NotifierService,\n\n\n  ) { }\n\n  ngOnInit() {\n    let dataSetting = this.currentMonthSetting();\n    this.listSalarySlipDetails(dataSetting.monthValue, dataSetting.year, 'later', false);\n    let monthValue = Number(dataSetting.monthValue);\n    for (var i = 1; i <= 12; i++) {\n      if (monthValue >= i) {\n        this.currentMonthValue[i.toString().padStart(2, '0')] = true;\n      } else {\n        this.currentMonthValue[i.toString().padStart(2, '0')] = false;\n      }\n    }\n    this.employeeList();\n  }\n\n  // Employee List\n  employeeList() {\n    try {\n      this.employeeListAPI.getEmployeeList(this.status).subscribe((data) => {\n        if (data.status === 'success') {\n          this.companyEmployeelist = data.data;\n        }\n      })\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  allDownload() {\n    try {\n      this.spinner.show();\n      if ((document.getElementById('salarySlipType') as HTMLInputElement).value === 'later') {\n        if (this.generateSalaryForEmployees.length === 0) {\n          this.spinner.hide();\n          Swal.fire('No Salary Slip Selected');\n        } else {\n\n          let generateSlip = {\n            employeeIdArray: this.generateSalaryForEmployees\n          }\n\n          let year = (document.getElementById('payrollYear') as HTMLInputElement).value\n          let month = (document.getElementById('salarySlipMonth') as HTMLInputElement).value\n          let currentDate = new Date();\n          if (Number(year) === currentDate.getFullYear()) {\n            this.api.monthlyGenerateSlip(generateSlip, month, year, 'multipleGenerate').forEach(async (data) => {\n              if (data.status === 'success') {\n                for (var i = 0; i < data.data.length; i++) {\n                  this.generatePdf(data.data[i]);\n                }\n                this.listSalarySlipDetails(month, year, 'later', false);\n                this.spinner.hide();\n              }\n            })\n            this.generateSalaryForEmployees = [];\n          } else {\n            this.api.generateSalarySlip(generateSlip, year, month).forEach((data) => {\n              if (data.status === 'success') {\n                for (var i = 0; i < data.data.length; i++) {\n                  this.generatePdf(data.data[i]);\n                }\n                this.listSalarySlipDetails(month, year, 'later', false);\n                this.spinner.hide();\n              }\n            })\n          }\n        }\n\n      } else if ((document.getElementById('salarySlipType') as HTMLInputElement).value === 'former') {\n        this.dataSalary.forEach((items) => {\n          this.generatePdf(items._id);\n        })\n        this.spinner.hide();\n      }\n      // this.spinner.hide();\n    } catch (error) {\n      console.log(error);\n      this.spinner.hide();\n    }\n  }\n\n  // download pdf start\n  async generatePdf(id) {\n    this.api.getSalarySlip(id).subscribe(async (data) => {\n      this.existingData = await data.data;\n      this.demo.push(data.data);\n\n      this.grossAmt = await data.data.gross.amt;\n      this.netSalaryAmt = await data.data.netSalary.amt;\n      this.totalDeductionAmt = await data.data.totalDeduction.amt;\n\n      this.employeeDetails = await data.data.employeeDetails;\n      var doc = await new jsPDF();\n      var image = new Image();\n\n      image.src = await data.data.companyImageUrl;\n\n      await doc.setFontSize(12);\n      await doc.rect(155, 20, 50, 24);\n      await doc.addImage(image, 'PNG', 170, 22, 20, 20, 'Default Logo', 'NONE');\n      await doc.rect(5, 20, 150, 8);\n      await doc.setFontStyle(\"bold\");\n      await doc.text(await this.employeeDetails.companyName, 75, 26, \"center\", \"a\");\n      await doc.setFontStyle(\"normal\");\n      await doc.rect(5, 28, 150, 8);\n      await doc.setFontStyle(\"bold\");\n      await doc.text(`Salary Slip for the Month of ${data.data.month}, ${data.data.year}`, 75, 34, \"center\", \"a\");\n      await doc.setFontStyle(\"normal\");\n      await doc.rect(5, 36, 75, 8);\n      await doc.text(\"Employee Name\", 22, 42, \"center\", \"a\");\n      await doc.rect(80, 36, 75, 8);\n      await doc.setFontStyle(\"bold\");\n      await doc.text(await this.employeeDetails.employeeName, 120, 42, \"center\", \"a\");\n      await doc.setFontStyle(\"normal\");\n\n\n      await doc.rect(5, 44, 50, 13);\n      await doc.text(\"Account No.\", 18, 52, \"center\", \"a\");\n      await doc.rect(55, 44, 50, 13);\n      if (await this.employeeDetails.accountNum) {\n        await doc.text(await this.employeeDetails.accountNum, 80, 52, \"center\", \"a\");\n      } else {\n        await doc.text('', 80, 52, \"center\", \"a\");\n      }\n      await doc.rect(105, 44, 50, 13);\n      await doc.text(\"Designation\", 125, 52, \"center\", \"a\");\n      await doc.rect(155, 44, 50, 13);\n      await doc.text(await this.employeeDetails.designation, 180, 52, \"center\", \"a\");\n\n      await doc.rect(5, 57, 50, 8);\n      await doc.text(\"Days Present\", 19, 63, \"center\", \"a\");\n      await doc.rect(55, 57, 50, 8);\n      await doc.text(await this.employeeDetails.present, 80, 63, \"center\", \"a\");\n      await doc.rect(105, 57, 50, 8);\n      await doc.text(\"Earned Leaves\", 125, 63, \"center\", \"a\");\n      await doc.rect(155, 57, 50, 8);\n      await doc.text(await this.employeeDetails.earnedLeaves, 175, 63, \"center\", \"a\");\n\n      await doc.rect(5, 65, 100, 8);\n      await doc.text(\"ESIC No :-\", 17, 71, \"center\", \"a\");\n      await doc.rect(105, 65, 100, 8);\n      await doc.text(\"P.F. No :-\", 120, 71, \"center\", \"a\");\n\n      await doc.rect(5, 73, 65, 8);\n      await doc.text(\"Leave Without Sanction\", 29, 79, \"center\", \"a\");\n      await doc.rect(70, 73, 35, 8);\n      await doc.text(await this.employeeDetails.unsanctionedLeave, 83, 79, \"center\", \"a\");\n      await doc.rect(105, 73, 60, 8);\n      await doc.text(\"Payable Days\", 125, 79, \"center\", \"a\");\n      await doc.rect(165, 73, 40, 8);\n      await doc.text(await this.employeeDetails.payDays, 180, 79, \"center\", \"a\");\n\n      await doc.rect(5, 81, 65, 8);\n      await doc.text(\"Total CTC/Month\", 22, 87, \"center\", \"a\");\n      await doc.rect(70, 81, 35, 8);\n      await doc.setFontStyle(\"bold\");\n      await doc.text(await this.employeeDetails.monthlyctc, 85, 87, \"center\", \"a\");\n      await doc.setFontStyle(\"normal\");\n      await doc.rect(105, 81, 60, 8);\n      await doc.text(\"Total CTC/Annum\", 129, 87, \"center\", \"a\");\n      await doc.rect(165, 81, 40, 8);\n      await doc.text(await this.employeeDetails.annuallyctc, 180, 87, \"center\", \"a\");\n\n      await doc.rect(5, 89, 100, 12);\n      await doc.setFontStyle(\"bold\");\n      await doc.text(\"Earnings\", 40, 97, \"center\", \"a\");\n      await doc.rect(105, 89, 100, 12);\n      await doc.text(\"Deductions\", 135, 97, \"center\", \"a\");\n\n\n      await doc.rect(5, 101, 65, 8);\n      await doc.rect(70, 101, 35, 8);\n      await doc.text(\"Amount\", 85, 107, \"center\", \"a\");\n      await doc.rect(105, 101, 60, 8);\n      await doc.rect(165, 101, 40, 8);\n      await doc.text(\"Amount\", 185, 107, \"center\", \"a\");\n      await doc.setFontStyle(\"normal\");\n\n      // Daynamic part start\n      var textY = 115;\n      var maxLength;\n      if (this.demo[0].deductions.length > this.demo[0].earnings.length) {\n        maxLength = await this.demo[0].deductions.length;\n      } else {\n        maxLength = await this.demo[0].earnings.length;\n      }\n      for (var i = 0; i < maxLength; i++) {\n        var rectY = textY - 6;\n        if (await this.demo[0].earnings[i] == undefined) {\n          await doc.rect(5, rectY, 65, 8);\n          await doc.rect(70, rectY, 35, 8);\n          textY = textY + 8;\n        } else {\n          await doc.rect(5, rectY, 65, 8);\n          await doc.text(this.demo[0].earnings[i].label, 8, textY, \"left\", \"a\");\n          await doc.rect(70, rectY, 35, 8);\n          await doc.text(this.demo[0].earnings[i].amt, 95, textY, \"center\", \"a\");\n        }\n        if (await this.demo[0].deductions[i] == undefined) {\n          await doc.rect(105, rectY, 60, 8);\n          await doc.rect(165, rectY, 40, 8);\n          textY = textY + 8;\n        } else {\n          await doc.rect(105, rectY, 60, 8);\n          await doc.text(this.demo[0].deductions[i].label, 117, textY, \"left\", \"a\");\n          await doc.rect(165, rectY, 40, 8);\n          await doc.text(this.demo[0].deductions[i].amt, 195, textY, \"center\", \"a\");\n          textY = textY + 8;\n        }\n      }\n\n      textY = textY - 6;\n      await doc.rect(5, textY, 65, 8);\n      await doc.text(\"Gross\", 13, textY + 6, \"center\", \"a\");\n      await doc.rect(70, textY, 35, 8);\n      await doc.text(this.grossAmt, 90, textY + 6, \"center\", \"a\");\n      await doc.rect(105, textY, 60, 8);\n      await doc.text(\"Total Deductions\", 134, textY + 6, \"center\", \"a\");\n      await doc.rect(165, textY, 40, 8);\n      await doc.text(this.totalDeductionAmt, 192, textY + 6, \"center\", \"a\");\n\n      textY = textY + 8;\n      await doc.rect(5, textY, 65, 8);\n      await doc.setFontStyle(\"bold\");\n      await doc.text(\"Net Salary\", 17, textY + 6, \"center\", \"a\");\n      await doc.rect(5, textY, 200, 8);\n      await doc.text(this.netSalaryAmt, 90, textY + 6, \"center\", \"a\");\n      await doc.setFontStyle(\"normal\");\n\n      textY = textY + 8;\n      await doc.rect(5, textY, 200, 8);\n\n      // doc.save('my.pdf');\n      await doc.save(this.employeeDetails.employeeName + '.pdf');\n    })\n  }\n\n  // account pdf start\n  accountpdfPdf() {\n\n\n    var doc = new jsPDF('a', 'mm', [700, 1000]);\n\n    doc.setFontSize(10);\n\n    var headerSpace = 30;\n\n    doc.text(18, headerSpace + 7, \"To\");\n\n    doc.text(23, headerSpace + 20, \"Indusind bank, Jaipur\");\n    doc.text(190, headerSpace + 7, \"Date:10/2019\");\n\n    doc.text(80, headerSpace + 30, \"Sub: Salary Transfer for the Month of sep 2019\");\n\n    doc.rect(15, headerSpace + 35, 200, 30);\n    doc.rect(15, headerSpace + 65, 200, 5);\n\n    doc.rect(15, headerSpace + 70, 15, 5);\n    doc.rect(15, headerSpace + 70, 70, 5);\n    doc.rect(15, headerSpace + 70, 105, 5);\n    doc.rect(15, headerSpace + 70, 140, 5);\n    doc.rect(15, headerSpace + 70, 200, 5);\n\n    doc.rect(15, headerSpace + 75, 15, 5); doc.text(\"Sr. No\", 17, headerSpace + 79, \"left\", \"a\");\n    doc.rect(15, headerSpace + 75, 70, 5); doc.text(\"Name\", 31, headerSpace + 79, \"left\", \"a\");\n    doc.rect(15, headerSpace + 75, 105, 5); doc.text(\"Account Number\", 86, headerSpace + 79, \"left\", \"a\");\n    doc.rect(15, headerSpace + 75, 140, 5); doc.text(\"Amount\", 123, headerSpace + 79, \"left\", \"a\");\n    doc.rect(15, headerSpace + 75, 200, 5); doc.text(\"Salary for the month\", 157, headerSpace + 79, \"left\", \"a\");\n\n    headerSpace = headerSpace + 80;\n    for (var i = 0; i < 20; i++) {\n      doc.rect(15, headerSpace, 15, 5);\n      doc.rect(15, headerSpace, 70, 5);\n      doc.rect(15, headerSpace, 105, 5);\n      doc.rect(15, headerSpace, 140, 5);\n      doc.rect(15, headerSpace, 200, 5);\n      headerSpace = headerSpace + 5;\n    }\n\n    // doc.addPage();\n\n    doc.save('my.pdf');\n  }\n  // accoutn pdf end\n\n  // Year Validation\n  yearValidation() {\n    try {\n      let currentDate = new Date();\n      let year = currentDate.getFullYear();\n      let yearValue = (document.getElementById('payrollYear') as HTMLInputElement).value;\n      let yearRegularExpression = /^(19|20)\\d{2}$/;\n      let result = yearValue.match(yearRegularExpression);\n\n      if (yearValue.length === 0 && result === null) {\n        this.earnedLeaveYearMsg = '';\n      } else if (result === null) {\n        this.earnedLeaveYearMsg = \"Year Value is not acceptable\";\n      } else {\n        this.earnedLeaveYearMsg = '';\n      }\n\n      if (Number(yearValue) < year) {\n        for (var key in this.currentMonthValue) {\n          this.currentMonthValue[key] = true;\n        }\n        (document.getElementById('salarySlipMonth') as HTMLInputElement).value = '01';\n      } else if (Number(yearValue) === year) {\n        let monthValue = currentDate.getMonth() + 1;\n        for (var i = 1; i <= 12; i++) {\n          if (monthValue >= i) {\n            this.currentMonthValue[i.toString().padStart(2, '0')] = true;\n          } else {\n            this.currentMonthValue[i.toString().padStart(2, '0')] = false;\n          }\n        }\n      } else if (Number(yearValue) > year) {\n        this.earnedLeaveYearMsg = \"Forthcoming data is not available\";\n      }\n\n\n\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  // Filter Functionality\n  filterFunctionality() {\n    this.selectAllCheckBox = false;\n\n    if ((document.getElementById('payrollYear') as HTMLInputElement).value.length === 0) {\n      let currentDate = new Date().toString();\n      (document.getElementById('payrollYear') as HTMLInputElement).value = currentDate.substring(11, 15);\n    }\n\n    if ((document.getElementById('salaryEmployee') as HTMLInputElement).value.length !== 0) {\n      this.filterEmployeeId = (document.getElementById('salaryEmployee') as HTMLInputElement).value;\n      let month = (document.getElementById('salarySlipMonth') as HTMLInputElement).value;\n      let year = (document.getElementById('payrollYear') as HTMLInputElement).value;\n      this.listSalarySlipDetails(month, year, 'later', true);\n    } else {\n      if ((document.getElementById('salarySlipType') as HTMLInputElement).value === 'former') {\n        this.currentSalarySlipFilterStatus = 'former';\n        let month = (document.getElementById('salarySlipMonth') as HTMLInputElement).value;\n        let year = (document.getElementById('payrollYear') as HTMLInputElement).value;\n\n        if ((document.getElementById('salaryModeType') as HTMLInputElement).value.length !== 0) {\n          let paymentMode = (document.getElementById('salaryModeType') as HTMLInputElement).value;\n          this.filterSalarySlip(paymentMode, year, month);\n        } else {\n          this.listSalarySlipDetails(month, year, 'former', false);\n        }\n\n      } else if ((document.getElementById('salarySlipType') as HTMLInputElement).value === 'later') {\n        this.currentSalarySlipFilterStatus = 'later';\n        let month = (document.getElementById('salarySlipMonth') as HTMLInputElement).value;\n        let year = (document.getElementById('payrollYear') as HTMLInputElement).value;\n\n        if ((document.getElementById('salaryModeType') as HTMLInputElement).value.length !== 0) {\n          let paymentMode = (document.getElementById('salaryModeType') as HTMLInputElement).value;\n          this.filterCurrentSalarySlip(paymentMode, year, month);\n        } else {\n          this.listSalarySlipDetails(month, year, 'later', false);\n        }\n      }\n    }\n\n    (document.getElementById('salaryModeType') as HTMLInputElement).value === 'Cheque'? this.showChequeBtn = true : this.showChequeBtn = false;\n\n  }\n\n  // Current Month Setting\n  currentMonthSetting() {\n    try {\n      let curretDate = new Date(); let manipulateDate, month, year, monthValue,\n        returnData = {\n          month: String,\n          year: String,\n          monthValue: String\n        };\n\n      monthValue = (curretDate.getMonth() + 1).toString().padStart(2, '0');\n      year = curretDate.toString();\n      year = year.substring(11, 15);\n      month = curretDate.toString();\n      month = month.substring(4, 7);\n      returnData.month = month;\n      returnData.monthValue = monthValue;\n      returnData.year = year;\n      (document.getElementById('payrollYear') as HTMLInputElement).value = year;\n      (document.getElementById(monthValue) as HTMLInputElement).setAttribute('selected', 'selected');\n      (document.getElementById('salarySlipType') as HTMLInputElement).value = 'later';\n\n      return (returnData);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // List Salary Slips\n  listSalarySlips(year, monthValue) {\n    try {\n      this.api.getPayrolData(year, monthValue).subscribe((data) => {\n        if (data.status === 'success') {\n          if (data.data.length > 0) {\n            this.dataSalary = data.data;\n            this.salarySlipStatus = '';\n          } else {\n            this.dataSalary = [];\n            this.salarySlipStatus = 'Salary Slip Not Found';\n          }\n        }\n      })\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // Filter Employee According to payment Mode\n  filterSalarySlip(modeType, year, month) {\n    try {\n\n      this.api.filterSalarySlip(modeType, year, month).subscribe((data) => {\n        if (data.status === 'success') {\n          if (data.data.length > 0) {\n            this.dataSalary = data.data;\n            this.salarySlipStatus = '';\n          } else {\n            this.dataSalary = [];\n            this.salarySlipStatus = 'No Salary Slip Found';\n          }\n        }\n      })\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // List Employee Salary Details\n  listSalarySlipDetails(monthValue, year, type, employeeFilter) {\n    try {\n      if (employeeFilter) {\n        this.api.listSalarySlipDetails(monthValue, year).subscribe((data) => {\n          if (data.status === 'success') {\n            this.dataSalary = [];\n            for (var i = 0; i < data.data.length; i++) {\n              if (data.data[i].isGenerated) {\n                if (data.data[i].employeeId == this.filterEmployeeId) {\n                  this.dataSalary.push(data.data[i]);\n                  (document.getElementById('salarySlipType') as HTMLInputElement).value = 'former';\n                  this.currentSalarySlipFilterStatus = 'former';\n                  break;\n                } else {\n                  continue;\n                }\n              } else if (!data.data[i].isGenerated) {\n                if (data.data[i]._id == this.filterEmployeeId) {\n                  this.dataSalary.push(data.data[i]);\n                  (document.getElementById('salarySlipType') as HTMLInputElement).value = 'later';\n                  this.currentSalarySlipFilterStatus = 'later';\n                  break;\n                } else {\n                  continue;\n                }\n              }\n            }\n\n            this.showSalaryDetailsCards = {};\n            this.showCheckbox = {};\n\n            for (var i = 0; i < this.dataSalary.length; i++) {\n              this.showSalaryDetailsCards[this.dataSalary[i]._id] = true;\n              if (!this.dataSalary[i].isGenerated) {\n                this.showCheckbox[this.dataSalary[i]._id] = false;\n              }\n            }\n\n            if (this.dataSalary.length === 0) {\n              this.salarySlipStatus = 'No Salary Slip Found';\n              this.selectAllCheckBox = false;\n            } else {\n              this.salarySlipStatus = '';\n            }\n          }\n        })\n      } else {\n        this.api.listSalarySlipDetails(monthValue, year).subscribe((data) => {\n          if (data.status === 'success') {\n            this.dataSalary = [];\n            if (type === 'later') {\n              for (var i = 0; i < data.data.length; i++) {\n                if (!data.data[i].isGenerated) {\n                  this.dataSalary.push(data.data[i]);\n                }\n              }\n            } else if (type === 'former') {\n              for (var i = 0; i < data.data.length; i++) {\n                if (data.data[i].isGenerated) {\n                  this.dataSalary.push(data.data[i]);\n                }\n              }\n            }\n\n            this.showSalaryDetailsCards = {};\n            this.showCheckbox = {};\n\n            for (var i = 0; i < this.dataSalary.length; i++) {\n              this.showSalaryDetailsCards[this.dataSalary[i]._id] = true;\n              if (!this.dataSalary[i].isGenerated) {\n                this.showCheckbox[this.dataSalary[i]._id] = false;\n              }\n            }\n            if (this.dataSalary.length === 0) {\n              this.salarySlipStatus = 'No Salary Slip Found';\n              this.selectAllCheckBox = false;\n            } else {\n              this.salarySlipStatus = '';\n            }\n          }\n        })\n      }\n\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // Header Checkbox Functionality\n  headerCheckBox() {\n    try {\n      this.selectAllCheckBox = !this.selectAllCheckBox;\n      if (this.selectAllCheckBox) {\n        this.generateSalaryForEmployees = [];\n        for (var key in this.showCheckbox) {\n          this.showCheckbox[key] = true;\n          this.generateSalaryForEmployees.push(key);\n        }\n      } else {\n        for (var key in this.showCheckbox) {\n          this.showCheckbox[key] = false;\n          this.generateSalaryForEmployees = [];\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // List CheckBoxes Functionalities\n  listCheckBoxes(id) {\n    try {\n      this.showCheckbox[id] = !this.showCheckbox[id];\n      if (this.showCheckbox[id]) {\n        this.generateSalaryForEmployees.push(id);\n      } else {\n        for (var i = 0; i < this.generateSalaryForEmployees.length; i++) {\n          if (id == this.generateSalaryForEmployees[i]) {\n            this.generateSalaryForEmployees.splice(i, 1);\n            break;\n          }\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // Show Salary Details\n  showSalarySlipDetails(employeeId) {\n    try {\n      this.showSalaryDetailsCards[employeeId] = !this.showSalaryDetailsCards[employeeId];\n      this.salarySlipDetails[employeeId] = {};\n      this.salarySlipDetails[employeeId].employeeSalaryDetails = [];\n      this.salarySlipDetails[employeeId].deductionDetails = [];\n      this.salarySlipDetails[employeeId].earningDetails = [];\n      for (var i = 0; i < this.dataSalary.length; i++) {\n        if (this.dataSalary[i]._id == employeeId) {\n          this.salarySlipDetails[employeeId].employeeSalaryDetails.push(this.dataSalary[i].employeeDetails);\n          this.salarySlipDetails[employeeId].deductionDetails = this.dataSalary[i].deductions;\n          this.salarySlipDetails[employeeId].earningDetails = this.dataSalary[i].earnings;\n          break;\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // Filter the later generate salary slip\n  filterCurrentSalarySlip(modeType, year, month) {\n    try {\n      this.showSalaryDetailsCards = {};\n      this.showCheckbox = {};\n\n      this.api.filterCurrentSalarySlip(modeType, year, month).subscribe((data) => {\n        if (data.status === 'success') {\n          if (data.data.length > 0) {\n\n            this.dataSalary = data.data;\n            this.salarySlipStatus = '';\n\n            for (var i = 0; i < data.data.length; i++) {\n              this.showSalaryDetailsCards[data.data[i]._id] = true;\n              if (!data.data[i].isGenerated) {\n                this.showCheckbox[data.data[i]._id] = false;\n              }\n            }\n          } else {\n            this.dataSalary = [];\n            this.salarySlipStatus = 'No Salary Slip Found';\n          }\n        }\n      })\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // Reset Functionality\n  resetFunctionality() {\n    try {\n      this.earnedLeaveYearMsg = '';\n      this.currentSalarySlipFilterStatus = 'later';\n      this.filterOnEmployee = false;\n      let dataSetting = this.currentMonthSetting();\n      let currentDate = new Date();\n      // let monthValue = (currentDate.getMonth()+1).toString().padStart(2,'0');\n      let monthValue = (currentDate.getMonth() + 1);\n      for (var i = 1; i <= 12; i++) {\n        if (monthValue >= i) {\n          this.currentMonthValue[i.toString().padStart(2, '0')] = true;\n        } else {\n          this.currentMonthValue[i.toString().padStart(2, '0')] = false;\n        }\n      }\n\n      (document.getElementById(`${dataSetting.monthValue}`) as HTMLInputElement).removeAttribute('selected');\n      (document.getElementById('salarySlipType') as HTMLInputElement).value = 'later';\n      (document.getElementById('salaryEmployee') as HTMLInputElement).value = '';\n      (document.getElementById('salaryModeType') as HTMLInputElement).value = '';\n      (document.getElementById('salarySlipMonth') as HTMLInputElement).value = monthValue.toString().padStart(2, '0');\n      this.listSalarySlipDetails(dataSetting.monthValue, dataSetting.year, 'later', false);\n\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  employeeFilter() {\n    this.filterOnEmployee = true;\n  }\n\n  // ADD CHEQUE NO.\n  addChequeNo(salaryId){\n    try {\n\n      this.api.getChequeApi(salaryId).subscribe(response => {\n        if(response.status === 'success'){\n          Swal.fire({\n            title: \"Cheque Details\",\n            text: \"Enter Cheque No.:\",\n            input: 'text',\n            inputValue: response.data.chequeNum,\n            showCancelButton: true,\n            inputValidator: (value) => {\n              return !value && 'Cheque No. Mandatory'\n            }\n            }).then((result) => {\n            if (result.value) {\n              this.api.addChequeApi(salaryId, {checkNum: result.value}).subscribe(response => {\n                (response.status === 'success') ?  this.notifier.notify(response.status, response.message) :\n                this.notifier.notify(response.status, response.message) ;\n              }, error => {\n                console.log(error);\n              });\n            }\n        });\n        }\n\n        if(response.status === 'error'){\n          this.notifier.notify(response.status, response.message);\n        }\n      }, error => {\n        console.log(error);\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n}\n\n\n","import { Component, OnInit,NgZone } from \"@angular/core\";\nimport { FormGroup, FormBuilder, FormControl, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\n\n\n@Component({\n    selector: 'app-add-payroll',\n    templateUrl: './add-payroll.component.html'\n})\n\nexport class AddPayrollComponent implements OnInit {\n    \n    constructor(){}\n\n    ngOnInit() {\n    }\n\n  }","<div class=\"card card-u\">\n   <div class=\"card-header\">\n      <h2 class=\"card-title text-center\" #target>Update Salary Slip</h2>\n   </div>\n\n   <div class=\"card-body\">\n      <div class=\"col-sm-offset-2\">\n         <p class=\"alert alert-danger\" *ngIf=\"errorMsg\">\n            <strong>{{errMsg}}</strong>\n         </p>\n      </div>\n      <div class=\"col-sm-offset-2\">\n         <p class=\"alert alert-success\" *ngIf=\"successMessage\">\n            <strong>{{successMsg}}</strong>\n         </p>\n      </div>\n\n      <form class=\"form-horizontal\" role=\"form\" [formGroup]=\"updateSalarySlipForm\">\n         <div [formGroup]=\"updateSalarySlipForm.get('employeeDetails')\">\n               <div class=\"row\">\n                 <div class=\"col-lg-6 col-md-6 col-sm-6\">\n                   <div class=\"form-group\">\n                      <label class=\"control-label \"><b>Employee Name:</b></label><br>\n                       <input type=\"text\" class=\"form-control\" formControlName=\"employeeName\" readonly>\n                     </div>\n                 </div>\n                 <div class=\"col-lg-6 col-md-6 col-sm-6\">\n                   <div class=\"form-group\">\n                     <label class=\"control-label \"><b>Designation:</b></label><br>\n                     <input type=\"text\" class=\"form-control\" formControlName=\"designation\" readonly>\n                 </div>\n                 </div>\n               </div>\n               <div class=\"row\">\n                  <div class=\"col-lg-6 col-md-6 col-sm-6\">\n                    <div class=\"form-group\">\n                       <label class=\"control-label\"><b>Present Days:</b></label><br>\n                        <input type=\"text\" class=\"form-control\" formControlName=\"present\">\n                      </div>\n                  </div>\n                  <div class=\"col-lg-6 col-md-6 col-sm-6\">\n                    <div class=\"form-group\">\n                      <label class=\"control-label col-sm-6\"><b>Pay Days:</b></label><br>\n                      <input type=\"text\" class=\"form-control\" formControlName=\"payDays\">\n                  </div>\n                  </div>\n                </div>\n                <div class=\"row\">\n                  <div class=\"col-lg-6 col-md-6 col-sm-6\">\n                    <div class=\"form-group\">\n                       <label class=\"control-label \"><b>Earned Leaves:</b></label><br>\n                        <input type=\"text\" class=\"form-control\" formControlName=\"earnedLeaves\" readonly>\n                      </div>\n                  </div>\n                  <div class=\"col-lg-6 col-md-6 col-sm-6\">\n                    <div class=\"form-group\">\n                      <label class=\"control-label \"><b>Unsactioned Leaves:</b></label><br>\n                      <input type=\"text\" class=\"form-control\" formControlName=\"unsanctionedLeave\" readonly>\n                  </div>\n                  </div>\n                </div>\n         </div>\n      </form>\n\n      <button class=\"btn btn-success\" (click)=\"showFunctinality()\">{{buttonValue}}</button>\n<div class=\"row\" *ngIf='showButtonValue'>\n<div class=\"col-lg-6 col-md-6 col-sm-6\">\n<!-- Earning Form Values -->\n<form class=\"form-horizontal\" role=\"form\" [formGroup]=\"earningsForm\">\n   <div [formGroup]=\"earningsForm.get('earnings')\">\n         <div class=\"edit-form-heading\">\n            <h3>Total Earnings</h3>\n         </div>\n   <div class=\"row\">\n      <div class=\"col-lg-6 col-md-6 col-sm-6\" *ngFor=\"let earnings of salarySlipEarnings\">\n         <div class=\"form-group\">\n            <label class=\"control-label \"><b>{{ earnings.label }}<sup class=\"redtext\">*</sup>:</b></label><br>\n            <input type=\"text\" class=\"form-control\" id=\"{{ earnings.label }}\" (keyup)=\"checkValidation(earnings.label)\" formControlName=\"{{earnings.label}}\">\n            <div><p class=\"errortext bottomspace-none\">{{salarySlipPattern[earnings.label]}}</p></div>\n        </div>\n      </div>\n   </div>\n   </div>\n</form>\n</div>\n<div class=\"col-lg-6 col-md-6 col-sm-6\">\n<!-- Deduction Form Values -->\n<form class=\"form-horizontal\" role=\"form\" [formGroup]=\"deductionForm\">\n   <div [formGroup]=\"deductionForm.get('deductions')\">\n         <div class=\"edit-form-heading\">\n            <h3>Total Deductions</h3>\n         </div>\n   <div class=\"row\">\n      <div class=\"col-lg-6 col-md-6 col-sm-6\" *ngFor=\"let deductions of salarySlipDeductions\">\n         <div class=\"form-group\">\n            <label class=\"control-label \"><b>{{ deductions.label }}<sup class=\"redtext\">*</sup>:</b></label><br>\n            <input type=\"text\" class=\"form-control\" id=\"{{ deductions.label }}\" (keyup)=\"checkValidation(deductions.label)\" formControlName=\"{{deductions.label}}\">\n            <div><p class=\"errortext bottomspace-none\">{{salarySlipPattern[deductions.label]}}</p></div>\n        </div>\n      </div>\n   </div>\n\n   </div>\n</form>\n   </div>\n</div>\n            <div class=\"form-group\">\n               <div class=\"\">\n                  <button type=\"submit\" class=\"btn btn-success\" [disabled]=\"didUpdate\" (click)=\"updateSalarySlip(target)\">Update</button>\n                  <button type=\"submit\" class=\"btn btn-danger\" routerLink=\"/pages/payroll/list-payroll\">Cancel</button>\n               </div>\n            </div>\n   </div>\n</div>","import { Component, OnInit, NgZone } from '@angular/core';\nimport { FormGroup, FormBuilder, FormControl, Validators, FormArray, FormArrayName } from '@angular/forms';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { PayrollApiService } from '../payroll-service/payroll-api.service';\n\n@Component({\n  selector: 'app-update-payroll',\n  templateUrl: 'update-payroll.component.html',\n  styleUrls:['update-payroll.component.scss']\n})\n\nexport class UpdatePayrollComponent implements OnInit {\nemployeeId: any;\nrequestMonth: any;\nrequestYear: any;\nexistingSalaryDetails: any;\nupdateSalarySlipForm: any;\nsalarySlipDeductions = [];\nsalarySlipEarnings = [];\ndeductionForm: any;\nearningsForm: any;\nbuttonValue = 'Show More';\nshowButtonValue = false;\nsalarySlipPattern = {};\ndidUpdate = false;\nupdatedSalaryForm: any;\nisGenerated: any;\nerrorMsg = false;\nsuccessMessage = false;\nerrMsg: any;\nsuccessMsg: any;\n\nconstructor(private api:PayrollApiService, private fb:FormBuilder,private route:ActivatedRoute,private ngZone: NgZone,private router:Router){}\n\nngOnInit() {\n  try {\n  this.employeeId = this.route.snapshot.paramMap.get(\"employeeId\");\n  this.requestMonth = this.route.snapshot.paramMap.get(\"month\");\n  this.requestYear = this.route.snapshot.paramMap.get(\"year\");\n  this.salarySlipForm();\n  this.api.listSalarySlipDetails(this.requestMonth,this.requestYear).subscribe((data)=>{\n    if(data.status === 'success'){\n      for(var i = 0; i<data.data.length; i++){\n        if(data.data[i]._id == this.employeeId){\n          this.existingSalaryDetails = data.data[i];\n          this.salarySlipDeductions = data.data[i].deductions;\n          this.salarySlipEarnings = data.data[i].earnings;\n          this.isGenerated = data.data[i].isGenerated;\n          break;\n        }\n      }\n      // Basic Details\n      this.updateSalarySlipForm = this.fb.group({\n        employeeDetails: new FormGroup ({\n          employeeName: new FormControl(this.existingSalaryDetails.employeeDetails.employeeName),\n          designation: new FormControl(this.existingSalaryDetails.employeeDetails.designation),\n          present: new FormControl(this.existingSalaryDetails.employeeDetails.present),\n          earnedLeaves: new FormControl(this.existingSalaryDetails.employeeDetails.earnedLeaves),\n          unsanctionedLeave: new FormControl(this.existingSalaryDetails.employeeDetails.unsanctionedLeave),\n          payDays: new FormControl(this.existingSalaryDetails.employeeDetails.payDays),\n        })\n      })\n\n      // Create Deduction Form Dynamically\n      let deduction = {};\n      this.salarySlipDeductions.forEach(totalDeductions =>{\n        deduction[totalDeductions.label] = new FormControl(totalDeductions.amt)\n        this.salarySlipPattern[totalDeductions.label] = '';\n      })\n      this.deductionForm = this.fb.group({\n        deductions: new FormGroup(deduction)\n      })\n\n      // Create Earnings Form Dynamically\n      let earnings = {};\n      this.salarySlipEarnings.forEach(totalEarnings=>{\n        earnings[totalEarnings.label] = new FormControl(totalEarnings.amt)\n        this.salarySlipPattern[totalEarnings.label] = '';\n      })\n      this.earningsForm = this.fb.group({\n        earnings: new FormGroup(earnings)\n      })\n    }\n  })\n  } catch (error) {\n    console.log(error);\n  }\n}\nsalarySlipForm(){\n  try {\n    this.updateSalarySlipForm = this.fb.group({\n      employeeDetails: new FormGroup ({\n        employeeName: new FormControl(''),\n        designation: new FormControl(''),\n        present: new FormControl(''),\n        earnedLeaves: new FormControl(''),\n        unsanctionedLeave: new FormControl(''),\n        payDays: new FormControl(''),\n      })\n    })\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nupdateSalarySlip(element){\n  try{\n    this.updatedSalaryForm = this.fb.group({\n      employeeDetails: new FormGroup({\n        employeeName: new FormControl(this.updateSalarySlipForm.get('employeeDetails.employeeName').value),\n        designation: new FormControl (this.updateSalarySlipForm.get('employeeDetails.designation').value),\n        present: new FormControl (this.updateSalarySlipForm.get('employeeDetails.present').value),\n        earnedLeaves: new FormControl (this.updateSalarySlipForm.get('employeeDetails.earnedLeaves').value),\n        unsanctionedLeave: new FormControl (this.updateSalarySlipForm.get('employeeDetails.unsanctionedLeave').value),\n        payDays: new FormControl (this.updateSalarySlipForm.get('employeeDetails.payDays').value),\n      }),\n      deductions : this.deductionForm,\n      earnings: this.earningsForm,\n      employeeIdArray: new FormArray([\n        new FormControl(this.employeeId),\n      ]),\n      isGenerated: new FormControl(this.isGenerated)\n    });\n\n   let currentDate = new Date();\n\n   // If salary Slip is not generated for the current month\n\n   if((currentDate.getMonth()+1).toString().padStart(2,'0') === this.requestMonth && !this.isGenerated){\n     this.api.monthlyGenerateSlip(this.updatedSalaryForm.value,this.requestMonth,this.requestYear,'Generate').subscribe((data)=>{\n       if(data.status === 'success'){\n         this.successMessage = true;\n         this.errorMsg = false;\n         this.successMsg = data.message;\n         setTimeout(() => {\n           this.router.navigateByUrl(\"/pages/payroll/list-payroll\");\n           this.handelErrors();\n         }, 2000);\n       } else if(data.status === 'error'){\n         this.successMessage = false;\n         this.errorMsg = true;\n         this.errMsg = data.message;\n         setTimeout(() => {\n           this.handelErrors();\n         }, 5000);\n       }\n     })\n   }\n\n   // If salary Slip is generated for the current month and user want to update the data\n   if((currentDate.getMonth()+1).toString().padStart(2,'0') === this.requestMonth && this.isGenerated){\n    this.api.monthlyGenerateSlip(this.updatedSalaryForm.value,this.requestMonth,this.requestYear,'Update').subscribe((data) =>{\n      if(data.status === 'success'){\n        this.successMessage = true;\n        this.errorMsg = false;\n        this.successMsg = data.message;\n        setTimeout(() => {\n          this.router.navigateByUrl(\"/pages/payroll/list-payroll\");\n          this.handelErrors();\n        }, 2000);\n      } else if(data.status === 'error'){\n        this.successMessage = false;\n        this.errorMsg = true;\n        this.errMsg = data.message;\n        setTimeout(() => {\n          this.handelErrors();\n        }, 5000);\n      }\n    })\n   }\n\n\n\n\n\n   element.scrollIntoView();\n  }catch(err){\n    console.log(err);\n  }\n}\n\nshowFunctinality(){\n  try{\n    this.showButtonValue = !this.showButtonValue;\n    if(this.showButtonValue){\n      this.buttonValue = 'Show Less';\n    } else {\n      this.buttonValue = 'Show More';\n    }\n  }catch(err){\n    console.log(err);\n  }\n}\n\ncheckValidation(label){\n  try {\n   if((document.getElementById(label)as HTMLInputElement).value.match(/^\\$?[0-9]?((\\.[0-9]+)|([0-9]+(\\.[0-9]+)?))$/) === null){\n     this.salarySlipPattern[label] = `${label} value is not acceptable`;\n   } else {\n    this.salarySlipPattern[label] = '';\n  }\n   for(var key in this.salarySlipPattern){\n     if(this.salarySlipPattern[key].length > 0){\n       this.didUpdate = true;\n       break;\n     } else {\n       this.didUpdate = false;\n     }\n   }\n\n  } catch (error) {\n    console.log(error)\n  }\n}\n\nhandelErrors(){\n  try {\n    this.successMessage = false;\n    this.errorMsg = false;\n    this.successMsg = '';\n    this.errMsg = '';\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n}","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Routes } from '@angular/router';\nimport { PayrollComponent } from './payroll.component';\nimport { AuthGuard } from 'src/app/authGuard/auth.guard';\nimport { ListPayrollComponent } from './list-payroll/list-report.component';\nimport { AddPayrollComponent } from './add-payroll/add-payroll.component';\nimport { UpdatePayrollComponent } from './update-payroll/update-report.component';\nimport { PayrollSheetComponent } from './payroll-sheet/payroll-sheet.component';\n\n\nconst route : Routes = [\n  {\n    path :'',\n    component : PayrollComponent,\n    canActivate:[AuthGuard],\n    children :[\n      {\n        path: 'list-payroll',\n        component: ListPayrollComponent,\n      },\n      {\n        path: 'add-payroll',\n        component: AddPayrollComponent\n      },\n      {\n        path: 'update-payroll/:employeeId/:month/:year',\n        component: UpdatePayrollComponent\n      },\n      {\n        path: 'payroll-sheet',\n        component: PayrollSheetComponent\n      },\n      {\n        path:'',\n        redirectTo :'list-payroll',\n        pathMatch:'full',\n      },\n    ],\n  }\n];\n\n@NgModule({\n  exports: [RouterModule],\n  imports: [\n    CommonModule,\n    RouterModule.forChild(route),\n  ]\n})\nexport class PayrollRoutingModule { }","import { Component, OnInit } from '@angular/core';\nimport { BsDatepickerConfig, BsDatepickerViewMode } from 'ngx-bootstrap/datepicker';\nimport moment from 'moment';\nimport { PayrollApiService } from '../payroll-service/payroll-api.service';\nimport { Workbook } from 'exceljs';\nimport * as fs from 'file-saver';\nimport Swal from 'sweetalert2';\nimport { TitleCasePipe } from '@angular/common';\n\n@Component({\n  selector: 'app-payroll-sheet',\n  templateUrl: './payroll-sheet.component.html',\n  styleUrls: ['./payroll-sheet.component.scss']\n})\nexport class PayrollSheetComponent implements OnInit {\n\n  minMode: BsDatepickerViewMode = 'month'; // change for month:year\n  bsValue = new Date();\n  bsConfig: Partial<BsDatepickerConfig>;\n  companyDetails: any;\n  requestDateDetails = {\n    year: `${new Date().getFullYear()}`,\n    month: `${new Date().getMonth() + 1}`.padStart(2,'0')\n  }\n\n  constructor(\n    private apiService: PayrollApiService,\n    private titleCase: TitleCasePipe,\n  ) {\n    this.bsConfig = Object.assign({}, {\n      minMode : this.minMode,\n      dateInputFormat: 'MM-YYYY'\n    });\n   }\n\n  ngOnInit(): void {\n    this.getCompanyDetails();\n  }\n\n  rangeDatesUpdated(dateValues){\n    try {\n      this.requestDateDetails = {\n        year: `${moment(dateValues).get('years')}`,\n        month: `${moment(dateValues).get('months') + 1}`.padStart(2,'0')\n      }\n\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  getCompanyDetails() {\n    this.apiService.getCompanyDetails(localStorage.getItem('companyId')).subscribe((companyDetails) => {\n      if(companyDetails.status === 'success') {\n        this.companyDetails = companyDetails.data;\n      }\n    })\n  }\n\n\n  // GENERATE SALARY UPLOAD(BANK STATEMENT)\n  statementSheet(sheetType) {\n    try {\n        this.apiService.bankStatement({year: this.requestDateDetails.year, month: this.requestDateDetails.month, statementType: sheetType}).subscribe(response => {\n\n        if(response.status === 'success'){\n\n            (response.data.bankStatement.length === 0) ?\n            sheetType === 'Bank' ?\n            Swal.fire(\"Bank Statement is not available or may be you didn't add Empolyees Bank Details\" ) :\n            sheetType === 'Cash' ?\n            Swal.fire(\"Cash Statement is not available\" ):\n            Swal.fire(\"Cheque Statement is not available\" )\n            : sheetType === 'Bank' ?\n            this.generateBankSheet(response.data) :\n            sheetType === 'Cash' ?\n            this.generateCashStatement(response.data):\n            this.generateChequeStatement(response.data);\n\n        }\n        if(response.status === 'error'){\n          Swal.fire(response.message);\n        }\n      });\n    } catch (error) {\n      console.log(error);\n    }\n\n  }\n\n// FOR GENRATE EXCEL SHEET FOR BANK STATEMENT\n  async generateBankSheet(bankStatementData) {\n      // Create workbook and worksheet\n      const workbook = new Workbook();\n      const worksheet = workbook.addWorksheet('Bank Statement');\n      const subHeading = [`We request you to transfer our Salary from Indusind salary account for the amount of   ${bankStatementData.totalAmoutPaid} (${this.titleCase.transform(bankStatementData.totalAmoutPaidWords)} Only). Please refer  transfer from Aryavrat Infotech Pvt. Ltd. to IndusInd Salary Account of IndusInd Bank of amount  ${bankStatementData.totalAmoutPaid}/-through cheque on 10th ${bankStatementData.month}.`];\n      const subject = 'IndusInd bank, Jaipur';\n      const tableSubHeading = [`Please find the list below for the salary transfer of ${bankStatementData.month} ${bankStatementData.year}`];\n      const header1 = bankStatementData.headerDetails;\n      const header2 = ['', '', '', '', ''];\n      const footer = [\n        ['', 'Total', '', bankStatementData.totalAmoutPaid, ''],\n      ];\n\n\n      const bankData = [];\n      for(let i = 0; i < bankStatementData.bankStatement.length; i++){\n        const data  = [];\n        data.push(i+1);\n        for(let key in bankStatementData.bankStatement[i]){\n           data.push(bankStatementData.bankStatement[i][key]);\n        }\n        bankData.push(data);\n      }\n          // Add Row and formatting\n      const subTitleRow = worksheet.addRow(['TO', '', '', '', 'Date : ' + bankStatementData.currentDate]);\n      worksheet.getCell('B2').value = subject;\n      // Add sheet heading\n      const sheetHeading = worksheet.addRow([bankStatementData.subject]);\n      worksheet.mergeCells('A3:E3');\n      worksheet.addRow([]);\n      sheetHeading.font = { name: 'Arial', family: 4, size: 10, underline: 'double', bold: true, };\n      sheetHeading.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };\n      // Add sheet sub heading\n      const sheetSubHeading1 = worksheet.addRow(subHeading);\n      worksheet.mergeCells('A5:E7');\n      sheetSubHeading1.getCell(5).border = { top: { style: 'thin' }, left: { style: 'thin' }, bottom: { style: 'thin' }, right: { style: 'thin' } };\n      sheetSubHeading1.getCell(5).alignment = { vertical: 'top', horizontal: 'left', wrapText: true };\n\n      // Add table sub heading\n      const sheetSubHeading2 = worksheet.addRow(tableSubHeading);\n      worksheet.mergeCells('A8:E8');\n      sheetSubHeading2.eachCell((cell, number) => {\n        cell.border = { top: { style: 'thin' }, left: { style: 'thin' }, bottom: { style: 'thin' }, right: { style: 'thin' } };\n        cell.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };\n      });\n\n      const headerRow1 = worksheet.addRow(header2);\n      headerRow1.eachCell((cell, number) => {\n        cell.border = { top: { style: 'thin' }, left: { style: 'thin' }, bottom: { style: 'thin' }, right: { style: 'thin' } };\n      });\n\n      const headerRow2 = worksheet.addRow(header1);\n      headerRow2.eachCell((cell, number) => {\n        cell.border = { top: { style: 'thin' }, left: { style: 'thin' }, bottom: { style: 'thin' }, right: { style: 'thin' } };\n        cell.font = { name: 'Arial', family: 4, size: 10, bold: true, };\n      });\n\n      worksheet.getColumn(2).width = 30;\n      worksheet.getColumn(3).width = 30;\n      worksheet.getColumn(5).width = 30;\n\n      bankData.forEach(d => {\n        const row = worksheet.addRow(d);\n        row.eachCell((cell, number) => {\n          cell.border = { top: { style: 'thin' }, left: { style: 'thin' }, bottom: { style: 'thin' }, right: { style: 'thin' } };\n          cell.alignment = { vertical: 'bottom', horizontal: 'left', wrapText: true };\n        });\n      });\n\n      footer.forEach(f => {\n        const footerRow = worksheet.addRow(f);\n        footerRow.eachCell((cell, number) => {\n          cell.border = { top: { style: 'thin' }, left: { style: 'thin' }, bottom: { style: 'thin' }, right: { style: 'thin' } };\n          cell.alignment = { vertical: 'bottom', horizontal: 'left', wrapText: true };\n          cell.font = { name: 'Arial', family: 4, size: 10, bold: true, };\n        });\n      });\n      // Generate Excel sheet\n      workbook.xlsx.writeBuffer().then((data) => {\n        const blob = new Blob([data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\n        fs.saveAs(blob, 'Bank Statement.xlsx');\n      });\n  }\n\n// FOR GENRATE EXCEL SHEET FOR CASH STATEMENT\n  async generateCashStatement(salaryStatementData){\n    try {\n         // Create workbook and worksheet\n    const workbook = new Workbook();\n    const worksheet = workbook.addWorksheet('Cash Statement');\n    worksheet.addRow([]);\n    worksheet.mergeCells('A2:E2');\n    worksheet.getCell('A2').value =`${salaryStatementData.companyName}, ${salaryStatementData.month} ${salaryStatementData.year}`;\n    worksheet.getCell('A2').font = { name: 'Trebuchet MS', family: 4, size: 15, bold: true, };\n    worksheet.getCell('A2').alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };\n    worksheet.addRow([]);\n    worksheet.addRow([]);\n\n    const header1 = salaryStatementData.headerDetails;\n    const data = [];\n\n    salaryStatementData.bankStatement.forEach((salaryInfo, index) => {\n      let salaryDetail = [index+1, salaryInfo.name, salaryInfo.cashAmt, '', ''];\n      data.push(salaryDetail);\n    });\n\n    const headerRow2 = worksheet.addRow(header1);\n    headerRow2.eachCell((cell) => {\n      cell.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };\n      cell.font = { name: 'Arial', family: 4, size: 10, bold: true, };\n    });\n\n    data.forEach(d => {\n      const row = worksheet.addRow(d);\n      row.eachCell((cell) => {\n        cell.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };\n      });\n    });\n\n\n    worksheet.getColumn(2).width = 30;\n    worksheet.getColumn(3).width = 30;\n    worksheet.getColumn(4).width = 30;\n    worksheet.getColumn(5).width = 30;\n\n        // Footer Row\n        const footerRow = worksheet.addRow(['Total','',salaryStatementData.totalCashAmtPaid,'']);\n        footerRow.font = { name: 'Arial', family: 4, size: 10, bold: true, };\n        footerRow.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };\n\n\n    // Generate Excel sheet\n    workbook.xlsx.writeBuffer().then((data) => {\n      const blob = new Blob([data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\n      fs.saveAs(blob, 'Cash-Statement.xlsx');\n    });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // FOR GENRATE EXCEL SHEET FOR CASH STATEMENT\n  async generateChequeStatement(salaryStatementData){\n    try {\n         // Create workbook and worksheet\n    const workbook = new Workbook();\n    const worksheet = workbook.addWorksheet('Cheque Statement');\n    worksheet.addRow([]);\n    worksheet.mergeCells('A2:E2');\n    worksheet.getCell('A2').value =`${salaryStatementData.companyName}, ${salaryStatementData.month} ${salaryStatementData.year}`;\n    worksheet.getCell('A2').font = { name: 'Trebuchet MS', family: 4, size: 15, bold: true, };\n    worksheet.getCell('A2').alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };\n    worksheet.addRow([]);\n    worksheet.addRow([]);\n\n    const header1 = salaryStatementData.headerDetails;\n    const data = [];\n\n    salaryStatementData.bankStatement.forEach((salaryInfo, index) => {\n      let salaryDetail = [index+1, salaryInfo.name, salaryInfo.chequeAmt, salaryInfo.chequeNum, '', ''];\n      data.push(salaryDetail);\n    });\n\n    const headerRow2 = worksheet.addRow(header1);\n    headerRow2.eachCell((cell) => {\n      cell.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };\n      cell.font = { name: 'Arial', family: 4, size: 10, bold: true, };\n    });\n\n    data.forEach(d => {\n      const row = worksheet.addRow(d);\n      row.eachCell((cell) => {\n        cell.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };\n      });\n    });\n\n\n    worksheet.getColumn(2).width = 30;\n    worksheet.getColumn(3).width = 30;\n    worksheet.getColumn(4).width = 30;\n    worksheet.getColumn(5).width = 30;\n\n        // Footer Row\n        const footerRow = worksheet.addRow(['Total', '', salaryStatementData.totalChequeAmtPaid, '', '', '']);\n        footerRow.font = { name: 'Arial', family: 4, size: 10, bold: true, };\n        footerRow.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };\n\n\n    // Generate Excel sheet\n    workbook.xlsx.writeBuffer().then((data) => {\n      const blob = new Blob([data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\n      fs.saveAs(blob, 'Cheque-Statement.xlsx');\n    });\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n}\n","<ngx-spinner bdColor=\"rgba(51,51,51,0.8)\" size=\"medium\" color=\"#fff\" type=\"timer\">\n</ngx-spinner>\n<notifier-container></notifier-container>\n<div class=\"card card-user\">\n    <div class=\"card-header\" >\n        <h2 class=\"card-title text-center\">Salary Sheets</h2>\n    </div>\n\n    <div class=\"card-body\">\n        <div class=\"form-row\">\n            <div class=\"col-lg-3 col-md-3 col-sm-12\">\n                <div class=\"form-group\">\n                    <div class=\"col-sm-offset-2\">\n                        <input type=\"text\" class=\"form-control\" [bsConfig]=\"bsConfig\" placeholder=\"Select Months\"  [bsValue]=\"bsValue\" bsDatepicker (bsValueChange)=\"rangeDatesUpdated($event)\">\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"col-lg-9 col-md-9 col-sm-12\" >\n                <div class=\"form-group sheet-btn\" >\n                    <button class=\"btn btn-secondary sheet-btn-format\" type=\"button\" (click) = \"statementSheet('Bank')\"><i class=\"fa fa-download\"></i>Bank Statement</button>\n                    <button class=\"btn btn-secondary sheet-btn-format\" type=\"button\" (click) = \"statementSheet('Cash')\"><i class=\"fa fa-download\"></i>Cash Statement</button>\n                    <button class=\"btn btn-secondary sheet-btn-format\" type=\"button\" (click) = \"statementSheet('Cheque')\"><i class=\"fa fa-download\"></i>Cheque Statement</button>\n                </div>\n            </div>\n        </div>\n\n\n\n        <table class=\"table\" style=\"margin: auto\">\n            <tr>\n                <td><strong>Name:</strong></td>\n                <td> {{companyDetails?.name}} </td>\n                <td><strong>Address:</strong></td>\n                <td> {{companyDetails?.address}} </td>\n            </tr>\n            <tr>\n                <td><strong>Domicile:</strong></td>\n                <td> {{companyDetails?.domicile}} </td>\n                <td><strong>Official Company Number:</strong></td>\n                <td> {{companyDetails?.officialNumber}} </td>\n            </tr>\n            <tr>\n                <td><strong>Fax Number:</strong></td>\n                <td> {{companyDetails?.fax}} </td>\n                <td><strong>Email Address:</strong></td>\n                <td> {{companyDetails?.email}} </td>\n            </tr>\n            <tr>\n                <td><strong>Bank Name:</strong></td>\n                <td> {{companyDetails?.bankName}} </td>\n                <td><strong>Account No:</strong></td>\n                <td> {{companyDetails?.bankAccNum}} </td>\n            </tr>\n            <tr>\n                <td><strong>Country:</strong></td>\n                <td> {{companyDetails?.countryName}} </td>\n                <td><strong>Currency:</strong></td>\n                <td> {{companyDetails?.currency}} </td>\n            </tr>\n            <tr>\n                <td><strong>Taxation No:</strong></td>\n                <td> {{companyDetails?.taxationNumber}} </td>\n                <td><strong>PAN No:</strong></td>\n                <td> {{companyDetails?.panNumber}} </td>\n            </tr>\n            <tr>\n                <td><strong>BCC Address for all outgoing mails:</strong></td>\n                <td> {{companyDetails?.bccEmail}} </td>\n                <td></td>\n                <td></td>\n            </tr>\n        </table>\n\n\n\n\n\n    </div>\n\n\n\n</div>","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { PayrollRoutingModule } from './payroll-routing.module';\nimport { PayrollComponent } from './payroll.component';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport { ListPayrollComponent } from './list-payroll/list-report.component';\nimport { AddPayrollComponent } from './add-payroll/add-payroll.component';\nimport { UpdatePayrollComponent } from './update-payroll/update-report.component';\nimport { NgxSpinnerModule } from 'ngx-spinner';\nimport { NotifierModule, NotifierOptions } from 'angular-notifier';\nimport { PayrollSheetComponent } from './payroll-sheet/payroll-sheet.component';\nimport { BsDatepickerModule } from 'ngx-bootstrap/datepicker';\n\nconst customNotifierOptions: NotifierOptions = {\n  position: {\n    horizontal: {\n      position: 'right',\n      distance: 12\n    },\n    vertical: {\n      position: 'top',\n      distance: 12,\n      gap: 10\n    }\n  },\n  theme: 'material',\n  behaviour: {\n    autoHide: 3000,\n    onClick: 'hide',\n    onMouseover: 'pauseAutoHide',\n    showDismissButton: true,\n    stacking: 4\n  },\n  animations: {\n    enabled: true,\n    show: {\n      preset: 'slide',\n      speed: 300,\n      easing: 'ease'\n    },\n    hide: {\n      preset: 'fade',\n      speed: 300,\n      easing: 'ease',\n      offset: 50\n    },\n    shift: {\n      speed: 300,\n      easing: 'ease'\n    },\n    overlap: 150\n  }\n};\n\n@NgModule({\n  declarations: [\n    PayrollComponent,\n    ListPayrollComponent,\n    AddPayrollComponent,\n    UpdatePayrollComponent,\n    PayrollSheetComponent\n  ],\n\n  imports: [\n    CommonModule,\n    PayrollRoutingModule,\n    FormsModule,\n    ReactiveFormsModule,\n    RouterModule,\n    NgxSpinnerModule,\n    NotifierModule.withConfig(customNotifierOptions),\n    BsDatepickerModule.forRoot(),\n\n  ]\n})\n\nexport class PayrollModule { }\n"]}